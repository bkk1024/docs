<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <link rel="icon" href="/docs/icon.png"><title>nest.js@8 | äºŒå¸ˆå¼Ÿçš„å­¦ä¹ ç¬”è®°</title><meta name="description" content="äºŒå¸ˆå¼Ÿçš„å­¦ä¹ ç¬”è®°">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/docs/assets/style-6d00d8ff.css" as="style"><link rel="stylesheet" href="/docs/assets/style-6d00d8ff.css">
    <link rel="modulepreload" href="/docs/assets/app-0ea0852b.js"><link rel="modulepreload" href="/docs/assets/framework-4f54a744.js"><link rel="modulepreload" href="/docs/assets/nestjs8.html-b8bc19ac.js"><link rel="modulepreload" href="/docs/assets/nestjs8.html-69be4e22.js"><link rel="prefetch" href="/docs/assets/index.html-873919fc.js" as="script"><link rel="prefetch" href="/docs/assets/vite3.html-d13a01c0.js" as="script"><link rel="prefetch" href="/docs/assets/webpack5.html-c5d53893.js" as="script"><link rel="prefetch" href="/docs/assets/phaser3.html-4625842b.js" as="script"><link rel="prefetch" href="/docs/assets/css.html-d0f02439.js" as="script"><link rel="prefetch" href="/docs/assets/echarts.html-89479e1e.js" as="script"><link rel="prefetch" href="/docs/assets/elementui.html-5297a3c5.js" as="script"><link rel="prefetch" href="/docs/assets/html.html-5b76f10d.js" as="script"><link rel="prefetch" href="/docs/assets/js.html-28c9c2f0.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-a89623a5.js" as="script"><link rel="prefetch" href="/docs/assets/uni-app.html-033fa626.js" as="script"><link rel="prefetch" href="/docs/assets/vue2.html-40efae7e.js" as="script"><link rel="prefetch" href="/docs/assets/vue3.html-465e0201.js" as="script"><link rel="prefetch" href="/docs/assets/vuex.html-1398b4b1.js" as="script"><link rel="prefetch" href="/docs/assets/webpack.html-db7c9f84.js" as="script"><link rel="prefetch" href="/docs/assets/WebSocket.html-cd585a4d.js" as="script"><link rel="prefetch" href="/docs/assets/jsæ–¹æ³•.html-8dbf21ec.js" as="script"><link rel="prefetch" href="/docs/assets/jsçŸ¥è¯†è¦ç‚¹.html-f2011264.js" as="script"><link rel="prefetch" href="/docs/assets/äº‹ä»¶å¾ªç¯.html-754a7f88.js" as="script"><link rel="prefetch" href="/docs/assets/å±æ€§æè¿°ç¬¦.html-6e334454.js" as="script"><link rel="prefetch" href="/docs/assets/æ–‡ä»¶ä¸Šä¼ .html-67af08e4.js" as="script"><link rel="prefetch" href="/docs/assets/æµè§ˆå™¨æ¸²æŸ“åŸç†.html-d31fa9b5.js" as="script"><link rel="prefetch" href="/docs/assets/è½®è¯¢.html-7068da83.js" as="script"><link rel="prefetch" href="/docs/assets/leetcodeç®—æ³•.html-fa89f797.js" as="script"><link rel="prefetch" href="/docs/assets/nestjsåšå®¢æ¥å£æ¡ˆä¾‹.html-b53faf37.js" as="script"><link rel="prefetch" href="/docs/assets/nodejs.html-e5252953.js" as="script"><link rel="prefetch" href="/docs/assets/nodejså’Œexpressé…åˆå‰ç«¯historyæ¨¡å¼.html-a773c754.js" as="script"><link rel="prefetch" href="/docs/assets/nvm.html-b8822afa.js" as="script"><link rel="prefetch" href="/docs/assets/pm2.html-17ac66b3.js" as="script"><link rel="prefetch" href="/docs/assets/é¡¹ç›®ç¬”è®°.html-82ac6c2d.js" as="script"><link rel="prefetch" href="/docs/assets/FastAPI.html-2767ac68.js" as="script"><link rel="prefetch" href="/docs/assets/excel.html-c6d7c8e8.js" as="script"><link rel="prefetch" href="/docs/assets/mongoDB.html-00172f1d.js" as="script"><link rel="prefetch" href="/docs/assets/selenium.html-e72897fa.js" as="script"><link rel="prefetch" href="/docs/assets/å¹¶å‘ç¼–ç¨‹.html-15ed4b91.js" as="script"><link rel="prefetch" href="/docs/assets/æ—¥å¿—æ¨¡å—.html-c9d55a69.js" as="script"><link rel="prefetch" href="/docs/assets/craco.html-4dcc1aa9.js" as="script"><link rel="prefetch" href="/docs/assets/react18.html-973190cf.js" as="script"><link rel="prefetch" href="/docs/assets/reactä½¿ç”¨lottie.html-79e48e92.js" as="script"><link rel="prefetch" href="/docs/assets/reactä½¿ç”¨svg.html-840f1048.js" as="script"><link rel="prefetch" href="/docs/assets/DOMå’ŒBOMå†…ç½®å¯¹è±¡.html-fa919f4f.js" as="script"><link rel="prefetch" href="/docs/assets/Decoratorè£…é¥°å™¨.html-0c6124dc.js" as="script"><link rel="prefetch" href="/docs/assets/Mixinsæ··å…¥.html-afa10a7b.js" as="script"><link rel="prefetch" href="/docs/assets/Objectå’Œobject.html-82bf395b.js" as="script"><link rel="prefetch" href="/docs/assets/Partialã€Pickã€Recordã€Readonly.html-b36d334c.js" as="script"><link rel="prefetch" href="/docs/assets/Proxyå’ŒReflect.html-e75ba7f9.js" as="script"><link rel="prefetch" href="/docs/assets/anyå’Œvoidå’Œnever.html-812dee82.js" as="script"><link rel="prefetch" href="/docs/assets/infer.html-3e1c5b47.js" as="script"><link rel="prefetch" href="/docs/assets/interfaceæ¥å£.html-cafcbbaa.js" as="script"><link rel="prefetch" href="/docs/assets/namespaceå‘½åç©ºé—´.html-2a194e1f.js" as="script"><link rel="prefetch" href="/docs/assets/reflect-metadataå…ƒæ•°æ®.html-ca5dbf44.js" as="script"><link rel="prefetch" href="/docs/assets/tsconfig.jsoné…ç½®.html-c7ce0fb7.js" as="script"><link rel="prefetch" href="/docs/assets/tsä½¿ç”¨Promise.html-82eaac6d.js" as="script"><link rel="prefetch" href="/docs/assets/tsåŸºæœ¬å†…å®¹.html-2c0fec89.js" as="script"><link rel="prefetch" href="/docs/assets/tsç¼–å†™å‘å¸ƒè®¢é˜…æ¨¡å¼.html-962b2645.js" as="script"><link rel="prefetch" href="/docs/assets/å£°æ˜æ–‡ä»¶d.ts.html-0ab897e3.js" as="script"><link rel="prefetch" href="/docs/assets/æ³›å‹.html-c779c98d.js" as="script"><link rel="prefetch" href="/docs/assets/ç±»å‹å…¼å®¹.html-88f7352c.js" as="script"><link rel="prefetch" href="/docs/assets/axios.html-a980e971.js" as="script"><link rel="prefetch" href="/docs/assets/pinia.html-11694eb7.js" as="script"><link rel="prefetch" href="/docs/assets/vue-router.html-15154da2.js" as="script"><link rel="prefetch" href="/docs/assets/vue3-vite-electron.html-b737965b.js" as="script"><link rel="prefetch" href="/docs/assets/vue3ä¸€äº›è‡ªå®šä¹‰æŒ‡ä»¤.html-f1303b63.js" as="script"><link rel="prefetch" href="/docs/assets/vue3å…¶ä»–ç¬”è®°.html-a901a8ef.js" as="script"><link rel="prefetch" href="/docs/assets/vue3å­¦ä¹ ç¬”è®°.html-6069da80.js" as="script"><link rel="prefetch" href="/docs/assets/vuepress.html-064a3f4c.js" as="script"><link rel="prefetch" href="/docs/assets/vueå¸¸è§ä¼˜åŒ–æ‰‹æ®µ.html-5f03036c.js" as="script"><link rel="prefetch" href="/docs/assets/å‰è¨€.html-c1e2974c.js" as="script"><link rel="prefetch" href="/docs/assets/ç¬¬ä¸€ç¯‡æ¡†æ¶è®¾è®¡æ¦‚è§ˆ.html-e4e87416.js" as="script"><link rel="prefetch" href="/docs/assets/ç¬¬äºŒç¯‡å“åº”ç³»ç»Ÿ.html-faa33985.js" as="script"><link rel="prefetch" href="/docs/assets/404.html-f04ced3e.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-007e3d49.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-482a2c47.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-5ec05c94.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-4ba11b22.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-d6e43004.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-5d079a57.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-2225520e.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-b1f72b95.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-9084f6b7.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-c11822d4.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-9db0214d.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-ccc17d87.js" as="script"><link rel="prefetch" href="/docs/assets/vite3.html-b95b7af5.js" as="script"><link rel="prefetch" href="/docs/assets/webpack5.html-f837636b.js" as="script"><link rel="prefetch" href="/docs/assets/phaser3.html-ed12c05d.js" as="script"><link rel="prefetch" href="/docs/assets/css.html-32556baf.js" as="script"><link rel="prefetch" href="/docs/assets/echarts.html-88d862ff.js" as="script"><link rel="prefetch" href="/docs/assets/elementui.html-15eb9d4d.js" as="script"><link rel="prefetch" href="/docs/assets/html.html-2b3cb614.js" as="script"><link rel="prefetch" href="/docs/assets/js.html-29a95c5e.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-2d6fc1ec.js" as="script"><link rel="prefetch" href="/docs/assets/uni-app.html-61008000.js" as="script"><link rel="prefetch" href="/docs/assets/vue2.html-a012d90f.js" as="script"><link rel="prefetch" href="/docs/assets/vue3.html-f8895c8e.js" as="script"><link rel="prefetch" href="/docs/assets/vuex.html-57a43e3d.js" as="script"><link rel="prefetch" href="/docs/assets/webpack.html-c10a1903.js" as="script"><link rel="prefetch" href="/docs/assets/WebSocket.html-ee5ee0b6.js" as="script"><link rel="prefetch" href="/docs/assets/jsæ–¹æ³•.html-826b1713.js" as="script"><link rel="prefetch" href="/docs/assets/jsçŸ¥è¯†è¦ç‚¹.html-c3b21c72.js" as="script"><link rel="prefetch" href="/docs/assets/äº‹ä»¶å¾ªç¯.html-fd1822db.js" as="script"><link rel="prefetch" href="/docs/assets/å±æ€§æè¿°ç¬¦.html-bde26b2a.js" as="script"><link rel="prefetch" href="/docs/assets/æ–‡ä»¶ä¸Šä¼ .html-14d341e7.js" as="script"><link rel="prefetch" href="/docs/assets/æµè§ˆå™¨æ¸²æŸ“åŸç†.html-1edfadbf.js" as="script"><link rel="prefetch" href="/docs/assets/è½®è¯¢.html-e55a71f2.js" as="script"><link rel="prefetch" href="/docs/assets/leetcodeç®—æ³•.html-d0bf9df8.js" as="script"><link rel="prefetch" href="/docs/assets/nestjsåšå®¢æ¥å£æ¡ˆä¾‹.html-2bb8adab.js" as="script"><link rel="prefetch" href="/docs/assets/nodejs.html-a9696c41.js" as="script"><link rel="prefetch" href="/docs/assets/nodejså’Œexpressé…åˆå‰ç«¯historyæ¨¡å¼.html-c9a26dac.js" as="script"><link rel="prefetch" href="/docs/assets/nvm.html-f3381fc6.js" as="script"><link rel="prefetch" href="/docs/assets/pm2.html-e8b31ba0.js" as="script"><link rel="prefetch" href="/docs/assets/é¡¹ç›®ç¬”è®°.html-4f4c4986.js" as="script"><link rel="prefetch" href="/docs/assets/FastAPI.html-e843e479.js" as="script"><link rel="prefetch" href="/docs/assets/excel.html-4592f699.js" as="script"><link rel="prefetch" href="/docs/assets/mongoDB.html-168c1dad.js" as="script"><link rel="prefetch" href="/docs/assets/selenium.html-47a64703.js" as="script"><link rel="prefetch" href="/docs/assets/å¹¶å‘ç¼–ç¨‹.html-b19fb1fa.js" as="script"><link rel="prefetch" href="/docs/assets/æ—¥å¿—æ¨¡å—.html-5cf3b3c1.js" as="script"><link rel="prefetch" href="/docs/assets/craco.html-de63a6cc.js" as="script"><link rel="prefetch" href="/docs/assets/react18.html-f0c244aa.js" as="script"><link rel="prefetch" href="/docs/assets/reactä½¿ç”¨lottie.html-f42ee1db.js" as="script"><link rel="prefetch" href="/docs/assets/reactä½¿ç”¨svg.html-a7bb6f7d.js" as="script"><link rel="prefetch" href="/docs/assets/DOMå’ŒBOMå†…ç½®å¯¹è±¡.html-cb757473.js" as="script"><link rel="prefetch" href="/docs/assets/Decoratorè£…é¥°å™¨.html-054dcadb.js" as="script"><link rel="prefetch" href="/docs/assets/Mixinsæ··å…¥.html-8533960b.js" as="script"><link rel="prefetch" href="/docs/assets/Objectå’Œobject.html-9830d052.js" as="script"><link rel="prefetch" href="/docs/assets/Partialã€Pickã€Recordã€Readonly.html-e52803be.js" as="script"><link rel="prefetch" href="/docs/assets/Proxyå’ŒReflect.html-3b2aa239.js" as="script"><link rel="prefetch" href="/docs/assets/anyå’Œvoidå’Œnever.html-5d23b979.js" as="script"><link rel="prefetch" href="/docs/assets/infer.html-12c3e7cf.js" as="script"><link rel="prefetch" href="/docs/assets/interfaceæ¥å£.html-458d3c87.js" as="script"><link rel="prefetch" href="/docs/assets/namespaceå‘½åç©ºé—´.html-ba48fb9e.js" as="script"><link rel="prefetch" href="/docs/assets/reflect-metadataå…ƒæ•°æ®.html-b3f40cbb.js" as="script"><link rel="prefetch" href="/docs/assets/tsconfig.jsoné…ç½®.html-0d4ad185.js" as="script"><link rel="prefetch" href="/docs/assets/tsä½¿ç”¨Promise.html-310b4aec.js" as="script"><link rel="prefetch" href="/docs/assets/tsåŸºæœ¬å†…å®¹.html-4b5230fb.js" as="script"><link rel="prefetch" href="/docs/assets/tsç¼–å†™å‘å¸ƒè®¢é˜…æ¨¡å¼.html-e5d4fdd6.js" as="script"><link rel="prefetch" href="/docs/assets/å£°æ˜æ–‡ä»¶d.ts.html-bc022730.js" as="script"><link rel="prefetch" href="/docs/assets/æ³›å‹.html-038c90c2.js" as="script"><link rel="prefetch" href="/docs/assets/ç±»å‹å…¼å®¹.html-f8928873.js" as="script"><link rel="prefetch" href="/docs/assets/axios.html-dd2f39ad.js" as="script"><link rel="prefetch" href="/docs/assets/pinia.html-9db217a3.js" as="script"><link rel="prefetch" href="/docs/assets/vue-router.html-b4b7800c.js" as="script"><link rel="prefetch" href="/docs/assets/vue3-vite-electron.html-16659694.js" as="script"><link rel="prefetch" href="/docs/assets/vue3ä¸€äº›è‡ªå®šä¹‰æŒ‡ä»¤.html-8ae6543c.js" as="script"><link rel="prefetch" href="/docs/assets/vue3å…¶ä»–ç¬”è®°.html-a35bf2f8.js" as="script"><link rel="prefetch" href="/docs/assets/vue3å­¦ä¹ ç¬”è®°.html-e385610c.js" as="script"><link rel="prefetch" href="/docs/assets/vuepress.html-020119f9.js" as="script"><link rel="prefetch" href="/docs/assets/vueå¸¸è§ä¼˜åŒ–æ‰‹æ®µ.html-06f0953d.js" as="script"><link rel="prefetch" href="/docs/assets/å‰è¨€.html-7983b7b7.js" as="script"><link rel="prefetch" href="/docs/assets/ç¬¬ä¸€ç¯‡æ¡†æ¶è®¾è®¡æ¦‚è§ˆ.html-59515c3e.js" as="script"><link rel="prefetch" href="/docs/assets/ç¬¬äºŒç¯‡å“åº”ç³»ç»Ÿ.html-0241c283.js" as="script"><link rel="prefetch" href="/docs/assets/404.html-e3821f77.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-aa8ddcf0.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-a554b704.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-02f7b1cd.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-7d3e4fca.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-2a9f6d0f.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-1e0216f7.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-c2818869.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-58785519.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-37eb7747.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-af439866.js" as="script"><link rel="prefetch" href="/docs/assets/index.html-ef04918a.js" as="script"><link rel="prefetch" href="/docs/assets/photoswipe.esm-6e6cbe40.js" as="script"><link rel="prefetch" href="/docs/assets/SearchResult-fd9b7c3b.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/docs/" class="brand"><img class="logo" src="/docs/icon.png" alt="äºŒå¸ˆå¼Ÿçš„å­¦ä¹ ç¬”è®°"><!----><span class="site-name hide-in-pad">äºŒå¸ˆå¼Ÿçš„å­¦ä¹ ç¬”è®°</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/docs/" class="nav-link" aria-label="é¦–é¡µ"><!---->é¦–é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è¯­è¨€"><span class="title"><!---->è¯­è¨€</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>JavaScript</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/js/js%E6%96%B9%E6%B3%95.html" class="nav-link" aria-label="jsè¯­è¨€ç”¨æ³•"><!---->jsè¯­è¨€ç”¨æ³•<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>TypeScript</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/ts/ts%E5%9F%BA%E6%9C%AC%E5%86%85%E5%AE%B9.html" class="nav-link" aria-label="tsè¯­è¨€ç”¨æ³•"><!---->tsè¯­è¨€ç”¨æ³•<!----></a></li><li class="dropdown-subitem"><a href="/docs/ts/tsconfig.json%E9%85%8D%E7%BD%AE.html" class="nav-link" aria-label="tsç›¸å…³æ–‡ä»¶"><!---->tsç›¸å…³æ–‡ä»¶<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>python</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/python/selenium.html" class="nav-link" aria-label="pythonçˆ¬è™«"><!---->pythonçˆ¬è™«<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ‰“åŒ…å·¥å…·"><span class="title"><!---->æ‰“åŒ…å·¥å…·</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/docs/build-tools/vite3.html" class="nav-link" aria-label="vite3"><!---->vite3<!----></a></li><li class="dropdown-item"><a href="/docs/build-tools/webpack5.html" class="nav-link" aria-label="webpack5"><!---->webpack5<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Node"><span class="title"><!---->Node</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>NodeJS</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/node/nvm.html" class="nav-link" aria-label="nvm"><!---->nvm<!----></a></li><li class="dropdown-subitem"><a href="/docs/node/nodejs.html" class="nav-link" aria-label="nodejs"><!---->nodejs<!----></a></li><li class="dropdown-subitem"><a href="/docs/node/pm2.html" class="nav-link" aria-label="pm2"><!---->pm2<!----></a></li><li class="dropdown-subitem"><a href="/docs/node/nodejs%E5%92%8Cexpress%E9%85%8D%E5%90%88%E5%89%8D%E7%AB%AFhistory%E6%A8%A1%E5%BC%8F.html" class="nav-link" aria-label="nodejs+express+history"><!---->nodejs+express+history<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>NestJS</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-current="page" href="/docs/node/nestjs8.html" class="router-link-active router-link-exact-active nav-link active" aria-label="nestjs"><!---->nestjs<!----></a></li><li class="dropdown-subitem"><a href="/docs/node/nestjs%E5%8D%9A%E5%AE%A2%E6%8E%A5%E5%8F%A3%E6%A1%88%E4%BE%8B.html" class="nav-link" aria-label="nestjsæ¡ˆä¾‹"><!---->nestjsæ¡ˆä¾‹<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Vue"><span class="title"><!---->Vue</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Vue3</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/vue3/vue3%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" class="nav-link" aria-label="vue3å­¦ä¹ ç¬”è®°"><!---->vue3å­¦ä¹ ç¬”è®°<!----></a></li><li class="dropdown-subitem"><a href="/docs/vue3/vue3%E5%85%B6%E4%BB%96%E7%AC%94%E8%AE%B0.html" class="nav-link" aria-label="vue3å…¶ä»–ç¬”è®°"><!---->vue3å…¶ä»–ç¬”è®°<!----></a></li><li class="dropdown-subitem"><a href="/docs/vue3/vue%E5%B8%B8%E8%A7%81%E4%BC%98%E5%8C%96%E6%89%8B%E6%AE%B5.html" class="nav-link" aria-label="ä¼˜åŒ–"><!---->ä¼˜åŒ–<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>VueRouter</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/vue3/vue-router.html" class="nav-link" aria-label="vue-router"><!---->vue-router<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>çŠ¶æ€ç®¡ç†</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/vue3/pinia.html" class="nav-link" aria-label="pinia"><!---->pinia<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ä¹¦ç±é˜…è¯»</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/vue3/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/%E5%89%8D%E8%A8%80.html" class="nav-link" aria-label="Vue.jsè®¾è®¡ä¸å®ç°"><!---->Vue.jsè®¾è®¡ä¸å®ç°<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>å…¶ä»–</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/vue3/axios.html" class="nav-link" aria-label="axios"><!---->axios<!----></a></li><li class="dropdown-subitem"><a href="/docs/vue3/vue3-vite-electron.html" class="nav-link" aria-label="electronæ¡Œé¢åº”ç”¨"><!---->electronæ¡Œé¢åº”ç”¨<!----></a></li><li class="dropdown-subitem"><a href="/docs/vue3/vuepress.html" class="nav-link" aria-label="VuePress"><!---->VuePress<!----></a></li><li class="dropdown-subitem"><a href="/docs/vue3/vue3%E4%B8%80%E4%BA%9B%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4.html" class="nav-link" aria-label="vue3ä¸€äº›è‡ªå®šä¹‰æŒ‡ä»¤"><!---->vue3ä¸€äº›è‡ªå®šä¹‰æŒ‡ä»¤<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="React"><span class="title"><!---->React</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>React18</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/react/react18.html" class="nav-link" aria-label="react18å­¦ä¹ ç¬”è®°"><!---->react18å­¦ä¹ ç¬”è®°<!----></a></li><li class="dropdown-subitem"><a href="/docs/react/react%E4%BD%BF%E7%94%A8svg.html" class="nav-link" aria-label="reactä½¿ç”¨svg"><!---->reactä½¿ç”¨svg<!----></a></li><li class="dropdown-subitem"><a href="/docs/react/react%E4%BD%BF%E7%94%A8lottie.html" class="nav-link" aria-label="reactä½¿ç”¨lottie"><!---->reactä½¿ç”¨lottie<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>å…¶ä»–</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/react/craco.html" class="nav-link" aria-label="craco"><!---->craco<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/docs/leetcode/leetcode%E7%AE%97%E6%B3%95.html" class="nav-link" aria-label="LeetCode"><!---->LeetCode<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/games/phaser3.html" class="nav-link" aria-label="æ¸¸æˆ"><!---->æ¸¸æˆ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/interview/" class="nav-link" aria-label="é¢è¯•"><!---->é¢è¯•<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/bkk1024/docs" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">æœç´¢</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">nodejs</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">nestjs</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/docs/node/nestjs8.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="nest.js@8"><!---->nest.js@8<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å®‰è£…-nestjs-cli" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®‰è£… nestjs cli"><!---->å®‰è£… nestjs cli<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#åˆ›å»º-nestjs-é¡¹ç›®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ›å»º nestjs é¡¹ç›®"><!---->åˆ›å»º nestjs é¡¹ç›®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#è¿è¡Œ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¿è¡Œ"><!---->è¿è¡Œ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ–‡ä»¶"><!---->æ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å¹³å°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¹³å°"><!---->å¹³å°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æ§åˆ¶å™¨-controller" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ§åˆ¶å™¨ï¼šController"><!---->æ§åˆ¶å™¨ï¼šController<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#åˆ›å»ºæ§åˆ¶å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ›å»ºæ§åˆ¶å™¨"><!---->åˆ›å»ºæ§åˆ¶å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æ„å»ºè·¯å¾„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ„å»ºè·¯å¾„"><!---->æ„å»ºè·¯å¾„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#è·¯ç”±" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è·¯ç”±"><!---->è·¯ç”±<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#request" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Request"><!---->Request<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#è·¯ç”±é€šé…ç¬¦" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è·¯ç”±é€šé…ç¬¦"><!---->è·¯ç”±é€šé…ç¬¦<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#çŠ¶æ€ç " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="çŠ¶æ€ç "><!---->çŠ¶æ€ç <!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#headers" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Headers"><!---->Headers<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#é‡å®šå‘" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é‡å®šå‘"><!---->é‡å®šå‘<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å­åŸŸè·¯ç”±" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å­åŸŸè·¯ç”±"><!---->å­åŸŸè·¯ç”±<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å¼‚æ­¥æ€§" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¼‚æ­¥æ€§"><!---->å¼‚æ­¥æ€§<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æä¾›è€…-providers" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æä¾›è€…ï¼šProviders"><!---->æä¾›è€…ï¼šProviders<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æœåŠ¡-service" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æœåŠ¡ï¼šService"><!---->æœåŠ¡ï¼šService<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#åˆ›å»º-service" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ›å»º service"><!---->åˆ›å»º service<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æ„å»ºä¸€ä¸ª-service" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ„å»ºä¸€ä¸ª service"><!---->æ„å»ºä¸€ä¸ª service<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#ä½¿ç”¨-service" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä½¿ç”¨ service"><!---->ä½¿ç”¨ service<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#ä¾èµ–æ³¨å…¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¾èµ–æ³¨å…¥"><!---->ä¾èµ–æ³¨å…¥<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æ¨¡å—-module" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ¨¡å—ï¼šModule"><!---->æ¨¡å—ï¼šModule<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#åˆ›å»ºæ¨¡å—-module" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åˆ›å»ºæ¨¡å— module"><!---->åˆ›å»ºæ¨¡å— module<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#åŠŸèƒ½æ¨¡å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŠŸèƒ½æ¨¡å—"><!---->åŠŸèƒ½æ¨¡å—<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#ä¾èµ–æ³¨å…¥-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¾èµ–æ³¨å…¥"><!---->ä¾èµ–æ³¨å…¥<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#åŠ¨æ€æ¨¡å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŠ¨æ€æ¨¡å—"><!---->åŠ¨æ€æ¨¡å—<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#ä¸­é—´ä»¶-middleware" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸­é—´ä»¶ï¼šmiddleware"><!---->ä¸­é—´ä»¶ï¼šmiddleware<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å®šä¹‰ä¸­é—´ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®šä¹‰ä¸­é—´ä»¶"><!---->å®šä¹‰ä¸­é—´ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#åº”ç”¨ä¸­é—´ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åº”ç”¨ä¸­é—´ä»¶"><!---->åº”ç”¨ä¸­é—´ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#ä¸­é—´ä»¶æ¶ˆè´¹è€…" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸­é—´ä»¶æ¶ˆè´¹è€…"><!---->ä¸­é—´ä»¶æ¶ˆè´¹è€…<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å‡½æ•°å¼ä¸­é—´ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‡½æ•°å¼ä¸­é—´ä»¶"><!---->å‡½æ•°å¼ä¸­é—´ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å¤šä¸ªä¸­é—´ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¤šä¸ªä¸­é—´ä»¶"><!---->å¤šä¸ªä¸­é—´ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å…¨å±€ä¸­é—´ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…¨å±€ä¸­é—´ä»¶"><!---->å…¨å±€ä¸­é—´ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å¼‚å¸¸è¿‡æ»¤å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¼‚å¸¸è¿‡æ»¤å™¨"><!---->å¼‚å¸¸è¿‡æ»¤å™¨<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#åŸºç¡€å¼‚å¸¸ç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŸºç¡€å¼‚å¸¸ç±»"><!---->åŸºç¡€å¼‚å¸¸ç±»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#è‡ªå®šä¹‰å¼‚å¸¸" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªå®šä¹‰å¼‚å¸¸"><!---->è‡ªå®šä¹‰å¼‚å¸¸<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å†…ç½®-http-å¼‚å¸¸" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å†…ç½® HTTP å¼‚å¸¸"><!---->å†…ç½® HTTP å¼‚å¸¸<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å¼‚å¸¸è¿‡æ»¤å™¨-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¼‚å¸¸è¿‡æ»¤å™¨"><!---->å¼‚å¸¸è¿‡æ»¤å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æ•è·æ‰€æœ‰å¼‚å¸¸" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ•è·æ‰€æœ‰å¼‚å¸¸"><!---->æ•è·æ‰€æœ‰å¼‚å¸¸<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#ç®¡é“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç®¡é“"><!---->ç®¡é“<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å†…ç½®ç®¡é“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å†…ç½®ç®¡é“"><!---->å†…ç½®ç®¡é“<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å¼€å‘ä¸€ä¸ªç®¡é“" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¼€å‘ä¸€ä¸ªç®¡é“"><!---->å¼€å‘ä¸€ä¸ªç®¡é“<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å¯¹è±¡ç»“æ„éªŒè¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å¯¹è±¡ç»“æ„éªŒè¯"><!---->å¯¹è±¡ç»“æ„éªŒè¯<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#class-validator" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="class-validator"><!---->class-validator<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#è·¯ç”±å®ˆå«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è·¯ç”±å®ˆå«"><!---->è·¯ç”±å®ˆå«<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æ‰§è¡Œä¸Šä¸‹æ–‡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ‰§è¡Œä¸Šä¸‹æ–‡"><!---->æ‰§è¡Œä¸Šä¸‹æ–‡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#è·¯ç”±å®ˆå«çº§åˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è·¯ç”±å®ˆå«çº§åˆ«"><!---->è·¯ç”±å®ˆå«çº§åˆ«<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#åå°„å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åå°„å™¨"><!---->åå°„å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#ç¤ºä¾‹-åŸºäºè§’è‰²çš„æƒé™éªŒè¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç¤ºä¾‹ï¼šåŸºäºè§’è‰²çš„æƒé™éªŒè¯"><!---->ç¤ºä¾‹ï¼šåŸºäºè§’è‰²çš„æƒé™éªŒè¯<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æ‹¦æˆªå™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ‹¦æˆªå™¨"><!---->æ‹¦æˆªå™¨<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#åŸºç¡€" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŸºç¡€"><!---->åŸºç¡€<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#å®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨"><!---->å®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#æ‹¦æˆªå™¨ä½œç”¨åŸŸ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ‹¦æˆªå™¨ä½œç”¨åŸŸ"><!---->æ‹¦æˆªå™¨ä½œç”¨åŸŸ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#è‡ªå®šä¹‰è£…é¥°å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªå®šä¹‰è£…é¥°å™¨"><!---->è‡ªå®šä¹‰è£…é¥°å™¨<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#è£…é¥°å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è£…é¥°å™¨"><!---->è£…é¥°å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#è‡ªå®šä¹‰" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è‡ªå®šä¹‰"><!---->è‡ªå®šä¹‰<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/node/nestjs8.html#ä¼ é€’æ•°æ®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¼ é€’æ•°æ®"><!---->ä¼ é€’æ•°æ®<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/docs/node/nestjs%E5%8D%9A%E5%AE%A2%E6%8E%A5%E5%8F%A3%E6%A1%88%E4%BE%8B.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸€ä¸ªä½¿ç”¨ NestJs ç¼–å†™çš„ç®€å•CRUDæ¡ˆä¾‹"><!---->ä¸€ä¸ªä½¿ç”¨ NestJs ç¼–å†™çš„ç®€å•CRUDæ¡ˆä¾‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->nest.js@8</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-03-02T13:23:18.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 24 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT24M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<!----></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å®‰è£…-nestjs-cli" class="router-link-active router-link-exact-active toc-link level2">å®‰è£… nestjs cli</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#åˆ›å»º-nestjs-é¡¹ç›®" class="router-link-active router-link-exact-active toc-link level2">åˆ›å»º nestjs é¡¹ç›®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#è¿è¡Œ" class="router-link-active router-link-exact-active toc-link level2">è¿è¡Œ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level2">æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å¹³å°" class="router-link-active router-link-exact-active toc-link level2">å¹³å°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æ§åˆ¶å™¨-controller" class="router-link-active router-link-exact-active toc-link level2">æ§åˆ¶å™¨ï¼šController</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#åˆ›å»ºæ§åˆ¶å™¨" class="router-link-active router-link-exact-active toc-link level3">åˆ›å»ºæ§åˆ¶å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æ„å»ºè·¯å¾„" class="router-link-active router-link-exact-active toc-link level3">æ„å»ºè·¯å¾„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#è·¯ç”±" class="router-link-active router-link-exact-active toc-link level3">è·¯ç”±</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#request" class="router-link-active router-link-exact-active toc-link level3">Request</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#è·¯ç”±é€šé…ç¬¦" class="router-link-active router-link-exact-active toc-link level3">è·¯ç”±é€šé…ç¬¦</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#çŠ¶æ€ç " class="router-link-active router-link-exact-active toc-link level3">çŠ¶æ€ç </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#headers" class="router-link-active router-link-exact-active toc-link level3">Headers</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#é‡å®šå‘" class="router-link-active router-link-exact-active toc-link level3">é‡å®šå‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å­åŸŸè·¯ç”±" class="router-link-active router-link-exact-active toc-link level3">å­åŸŸè·¯ç”±</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å¼‚æ­¥æ€§" class="router-link-active router-link-exact-active toc-link level3">å¼‚æ­¥æ€§</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æä¾›è€…-providers" class="router-link-active router-link-exact-active toc-link level2">æä¾›è€…ï¼šProviders</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æœåŠ¡-service" class="router-link-active router-link-exact-active toc-link level2">æœåŠ¡ï¼šService</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#åˆ›å»º-service" class="router-link-active router-link-exact-active toc-link level3">åˆ›å»º service</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æ„å»ºä¸€ä¸ª-service" class="router-link-active router-link-exact-active toc-link level3">æ„å»ºä¸€ä¸ª service</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#ä½¿ç”¨-service" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨ service</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#ä¾èµ–æ³¨å…¥" class="router-link-active router-link-exact-active toc-link level3">ä¾èµ–æ³¨å…¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æ¨¡å—-module" class="router-link-active router-link-exact-active toc-link level2">æ¨¡å—ï¼šModule</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#åˆ›å»ºæ¨¡å—-module" class="router-link-active router-link-exact-active toc-link level3">åˆ›å»ºæ¨¡å— module</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#åŠŸèƒ½æ¨¡å—" class="router-link-active router-link-exact-active toc-link level3">åŠŸèƒ½æ¨¡å—</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#ä¾èµ–æ³¨å…¥-1" class="router-link-active router-link-exact-active toc-link level3">ä¾èµ–æ³¨å…¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#åŠ¨æ€æ¨¡å—" class="router-link-active router-link-exact-active toc-link level3">åŠ¨æ€æ¨¡å—</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#ä¸­é—´ä»¶-middleware" class="router-link-active router-link-exact-active toc-link level2">ä¸­é—´ä»¶ï¼šmiddleware</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å®šä¹‰ä¸­é—´ä»¶" class="router-link-active router-link-exact-active toc-link level3">å®šä¹‰ä¸­é—´ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#åº”ç”¨ä¸­é—´ä»¶" class="router-link-active router-link-exact-active toc-link level3">åº”ç”¨ä¸­é—´ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#ä¸­é—´ä»¶æ¶ˆè´¹è€…" class="router-link-active router-link-exact-active toc-link level3">ä¸­é—´ä»¶æ¶ˆè´¹è€…</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å‡½æ•°å¼ä¸­é—´ä»¶" class="router-link-active router-link-exact-active toc-link level3">å‡½æ•°å¼ä¸­é—´ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å¤šä¸ªä¸­é—´ä»¶" class="router-link-active router-link-exact-active toc-link level3">å¤šä¸ªä¸­é—´ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å…¨å±€ä¸­é—´ä»¶" class="router-link-active router-link-exact-active toc-link level3">å…¨å±€ä¸­é—´ä»¶</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å¼‚å¸¸è¿‡æ»¤å™¨" class="router-link-active router-link-exact-active toc-link level2">å¼‚å¸¸è¿‡æ»¤å™¨</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#åŸºç¡€å¼‚å¸¸ç±»" class="router-link-active router-link-exact-active toc-link level3">åŸºç¡€å¼‚å¸¸ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#è‡ªå®šä¹‰å¼‚å¸¸" class="router-link-active router-link-exact-active toc-link level3">è‡ªå®šä¹‰å¼‚å¸¸</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å†…ç½®-http-å¼‚å¸¸" class="router-link-active router-link-exact-active toc-link level3">å†…ç½® HTTP å¼‚å¸¸</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å¼‚å¸¸è¿‡æ»¤å™¨-1" class="router-link-active router-link-exact-active toc-link level3">å¼‚å¸¸è¿‡æ»¤å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æ•è·æ‰€æœ‰å¼‚å¸¸" class="router-link-active router-link-exact-active toc-link level3">æ•è·æ‰€æœ‰å¼‚å¸¸</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#ç®¡é“" class="router-link-active router-link-exact-active toc-link level2">ç®¡é“</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å†…ç½®ç®¡é“" class="router-link-active router-link-exact-active toc-link level3">å†…ç½®ç®¡é“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å¼€å‘ä¸€ä¸ªç®¡é“" class="router-link-active router-link-exact-active toc-link level3">å¼€å‘ä¸€ä¸ªç®¡é“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å¯¹è±¡ç»“æ„éªŒè¯" class="router-link-active router-link-exact-active toc-link level3">å¯¹è±¡ç»“æ„éªŒè¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#class-validator" class="router-link-active router-link-exact-active toc-link level3">class-validator</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#è·¯ç”±å®ˆå«" class="router-link-active router-link-exact-active toc-link level2">è·¯ç”±å®ˆå«</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æ‰§è¡Œä¸Šä¸‹æ–‡" class="router-link-active router-link-exact-active toc-link level3">æ‰§è¡Œä¸Šä¸‹æ–‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#è·¯ç”±å®ˆå«çº§åˆ«" class="router-link-active router-link-exact-active toc-link level3">è·¯ç”±å®ˆå«çº§åˆ«</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#åå°„å™¨" class="router-link-active router-link-exact-active toc-link level3">åå°„å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#ç¤ºä¾‹-åŸºäºè§’è‰²çš„æƒé™éªŒè¯" class="router-link-active router-link-exact-active toc-link level3">ç¤ºä¾‹ï¼šåŸºäºè§’è‰²çš„æƒé™éªŒè¯</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æ‹¦æˆªå™¨" class="router-link-active router-link-exact-active toc-link level2">æ‹¦æˆªå™¨</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#åŸºç¡€" class="router-link-active router-link-exact-active toc-link level3">åŸºç¡€</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#å®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨" class="router-link-active router-link-exact-active toc-link level3">å®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#æ‹¦æˆªå™¨ä½œç”¨åŸŸ" class="router-link-active router-link-exact-active toc-link level3">æ‹¦æˆªå™¨ä½œç”¨åŸŸ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#è‡ªå®šä¹‰è£…é¥°å™¨" class="router-link-active router-link-exact-active toc-link level2">è‡ªå®šä¹‰è£…é¥°å™¨</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#è£…é¥°å™¨" class="router-link-active router-link-exact-active toc-link level3">è£…é¥°å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#è‡ªå®šä¹‰" class="router-link-active router-link-exact-active toc-link level3">è‡ªå®šä¹‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/node/nestjs8.html#ä¼ é€’æ•°æ®" class="router-link-active router-link-exact-active toc-link level3">ä¼ é€’æ•°æ®</a></li><!----><!--]--></ul><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="nest-js-8" tabindex="-1"><a class="header-anchor" href="#nest-js-8" aria-hidden="true">#</a> nest.js@8</h1><h2 id="å®‰è£…-nestjs-cli" tabindex="-1"><a class="header-anchor" href="#å®‰è£…-nestjs-cli" aria-hidden="true">#</a> å®‰è£… nestjs cli</h2><p><code>npm i -g @nestjs/cli</code> nestjs çš„è„šæ‰‹æ¶èƒ½æ›´ç®€å•çš„åˆ›å»ºé¡¹ç›®</p><h2 id="åˆ›å»º-nestjs-é¡¹ç›®" tabindex="-1"><a class="header-anchor" href="#åˆ›å»º-nestjs-é¡¹ç›®" aria-hidden="true">#</a> åˆ›å»º nestjs é¡¹ç›®</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&gt; nest new
? What name would you like to use for the new project?(nest-app) my-project(è¿™æ˜¯æ–°é¡¹ç›®çš„åç§°ï¼Œå¯ä»¥éšä¾¿å–å)
... // åˆ›å»ºä¸€ç³»åˆ—æ–‡ä»¶
? Which package manager would you â–¡â–¡ to use? (Use arrow keys) // é€‰æ‹©åŒ…ç®¡ç†å™¨
&gt; npm
  yarn
  pnpm
âˆš Installation in progress... // åˆ›å»ºé¡¹ç›®å®Œæˆ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è¿è¡Œ" tabindex="-1"><a class="header-anchor" href="#è¿è¡Œ" aria-hidden="true">#</a> è¿è¡Œ</h2><p><code>npm run start:dev</code>ï¼šè¿è¡Œé¡¹ç›®å¹¶å¼€å¯ç›‘è§†æ¨¡å¼ï¼ˆ--watchï¼‰ï¼Œåœ¨ <code>package.json</code> æ–‡ä»¶ä¸­å¯ä»¥æŸ¥çœ‹å®Œæ•´å‘½ä»¤</p><h2 id="æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#æ–‡ä»¶" aria-hidden="true">#</a> æ–‡ä»¶</h2><ul><li><code>app.controller.ts</code>ï¼šå¸¦æœ‰å•ä¸ªè·¯ç”±çš„åŸºæœ¬æ§åˆ¶å™¨</li><li><code>app.controller.spec.ts</code>ï¼šé’ˆå¯¹æ§åˆ¶å™¨çš„å•å…ƒæµ‹è¯•</li><li><code>app.module.ts</code>ï¼šåº”ç”¨ç¨‹åºçš„æ ¹æ¨¡å—ï¼ˆroot moduleï¼‰</li><li><code>main.ts</code>ï¼šåº”ç”¨ç¨‹åºçš„å…¥å£æ–‡ä»¶ï¼Œå®ƒä½¿ç”¨æ ¸å¿ƒå‡½æ•°<code>nestFactory</code>æ¥åˆ›å»º Nest åº”ç”¨ç¨‹åºçš„å®ä¾‹</li></ul><blockquote><p><code>main.ts</code>æ–‡ä»¶ä¸­åŒ…å«äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œæ­¤å‡½æ•°å°†**å¼•å¯¼(bootstrap)**åº”ç”¨ç¨‹åºçš„å¯åŠ¨æµç¨‹ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* main.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> NestFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/core&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./app.module&quot;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> app <span class="token operator">=</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
	<span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦åˆ›å»ºä¸€ä¸ª Nest åº”ç”¨ç¨‹åºçš„å®ä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code>NestFactory</code>æ ¸å¿ƒç±»ã€‚<code>NestFactory</code>æš´éœ²äº†ä¸€äº›é™æ€æ–¹æ³•ç”¨äºåˆ›å»ºåº”ç”¨ç¨‹åºçš„å®ä¾‹ã€‚å…¶ä¸­ï¼Œ<code>create()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å®ç°äº†<code>INestApplication</code>æ¥å£ã€‚</p><p>åœ¨ä¸Šé¢<code>main.ts</code>ç¤ºä¾‹ä¸­ï¼Œä»…å¯åŠ¨äº† HTTP ä¾¦å¬å™¨ï¼Œè¯¥ä¾¦å¬å™¨ä½¿åº”ç”¨ç¨‹åºå¯ä»¥ä¾¦å¬å…¥æ ˆçš„ HTTP è¯·æ±‚ã€‚</p></blockquote><h2 id="å¹³å°" tabindex="-1"><a class="header-anchor" href="#å¹³å°" aria-hidden="true">#</a> å¹³å°</h2><p>ç›®å‰æ”¯æŒä¸¤ä¸ª HTTP å¹³å°ï¼š<a href="https://expressjs.com/" target="_blank" rel="noopener noreferrer">express<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> å’Œ <a href="https://www.fastify.io/" target="_blank" rel="noopener noreferrer">fastify<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ã€‚</p><p>æ— è®ºä½¿ç”¨å“ªä¸ªå¹³å°ï¼Œéƒ½ä¼šå°†å¹³å°çš„ application æ¥å£æš´éœ²å‡ºæ¥ã€‚å®ƒä»¬åˆ†åˆ«æ˜¯<code>NestExpressApplication</code>å’Œ<code>NestFastifyApplicetion</code>ã€‚</p><p>å½“å°†ç±»å‹ä¿¡æ¯ä¼ é€’ç»™<code>NestFactory.create()</code>æ–¹æ³•æ—¶ï¼Œ<code>app</code>å¯¹è±¡å°†å…·æœ‰è¯¥ç‰¹å®šå¹³å°çš„ä¸“ç”¨æ–¹æ³•ã€‚ä½†æ˜¯è¦æ³¨æ„ï¼Œ<strong>é™¤éç¡®å®éœ€è¦è®¿é—®åº•å±‚å¹³å°çš„ APIï¼Œå¦åˆ™æ— éœ€æŒ‡å®šå¹³å°ç±»å‹ã€‚</strong></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span>NestExpressApplication<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="æ§åˆ¶å™¨-controller" tabindex="-1"><a class="header-anchor" href="#æ§åˆ¶å™¨-controller" aria-hidden="true">#</a> æ§åˆ¶å™¨ï¼šController</h2><p>æ§åˆ¶å±‚è´Ÿè´£å¤„ç†ä¼ å…¥çš„ HTTP è¯·æ±‚ï¼Œåœ¨ nest ä¸­ï¼Œæ§åˆ¶å™¨æ˜¯è¦ç»™å¸¦æœ‰<code>@Controller()</code>è£…é¥°å™¨çš„ç±»ã€‚</p><p><code>controller</code>ï¼šæ§åˆ¶å™¨ï¼Œç”¨æ¥æä¾› api æ¥å£ï¼Œè´Ÿè´£å¤„ç†<strong>è·¯ç”±ã€ä¸­è½¬ã€éªŒè¯ç­‰ä¸€äº›ç®€æ´çš„ä¸šåŠ¡</strong></p><p><a href="https://docs.nestjs.cn/8/controllers" target="_blank" rel="noopener noreferrer">å®Œæ•´æ–‡æ¡£é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="åˆ›å»ºæ§åˆ¶å™¨" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºæ§åˆ¶å™¨" aria-hidden="true">#</a> åˆ›å»ºæ§åˆ¶å™¨</h3><p>å®Œæ•´å†™æ³•ï¼š<code>nest generate controller</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>nest generate controller
? What name would you like to use for the controller? myController (è¿™æ˜¯controllerçš„åç§°ï¼Œå¯ä»¥éšä¾¿å¡«å†™)

// ç®€å†™
nest g co
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ„å»ºè·¯å¾„" tabindex="-1"><a class="header-anchor" href="#æ„å»ºè·¯å¾„" aria-hidden="true">#</a> æ„å»ºè·¯å¾„</h3><ul><li>è¿™é‡Œæ„å»ºä¸€ä¸ªåä¸º<code>/users</code>çš„è·¯å¾„</li></ul><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Delete<span class="token punctuation">,</span> HttpStatus<span class="token punctuation">,</span> Params<span class="token punctuation">,</span> Body <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span> <span class="token comment">// è¿™é‡Œå£°æ˜è¿™ä¸ªæ§åˆ¶å™¨ä¸‹æ‰€æœ‰çš„æ¥å£éƒ½å½’å±äº /users è¿™ä¸ªè·¯å¾„</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
	<span class="token comment">// åˆ›å»ºä¸€ä¸ª get è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚çš„è·¯å¾„ä¸º /users</span>
	<span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">getAllUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// åˆ›å»ºä¸€ä¸ªå¸¦å‚æ•°çš„ get è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚çš„è·¯å¾„ä¸º /users/:id</span>
	<span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&quot;:id&quot;</span><span class="token punctuation">)</span>
	<span class="token function">getUserById</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Params</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// ä½¿ç”¨ @Params() è£…é¥°å™¨å¯ä»¥è·å–åˆ°ä¼ å…¥çš„æ‰€æœ‰å‚æ•°</span>
		<span class="token keyword">return</span> params<span class="token punctuation">.</span>id
	<span class="token punctuation">}</span>

	<span class="token comment">// åˆ›å»ºä¸€ä¸ª post è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚çš„è·¯å¾„ä¸º /users/add</span>
	<span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span>
	<span class="token function">addUser</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// ä½¿ç”¨ @Body() è£…é¥°å™¨å¯ä»¥è·å–åˆ° post è¯·æ±‚ä¼ å…¥çš„ body ä¸­çš„å€¼</span>
		<span class="token keyword">return</span> body
	<span class="token punctuation">}</span>

	<span class="token comment">// åˆ›å»ºä¸€ä¸ª delete è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚çš„è·¯å¾„ä¸º /users/del/:id</span>
	<span class="token decorator"><span class="token at operator">@</span><span class="token function">Delete</span></span><span class="token punctuation">(</span><span class="token string">&quot;del/:id&quot;</span><span class="token punctuation">)</span>
	<span class="token function">removeUserById</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Params</span></span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// åœ¨ @Params() è£…é¥°å™¨ä¸­ä¼ å…¥å‚æ•°å³å¯æŒ‡å®šè¯»å–ä¼ å…¥è¿›æ¥çš„ params å‚æ•°</span>
		<span class="token keyword">return</span> id
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#è·¯ç”±" aria-hidden="true">#</a> è·¯ç”±</h3><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>@Controller()</code> è£…é¥°å™¨å®šä¹‰äº†ä¸€ä¸ªåŸºæœ¬çš„æ§åˆ¶å™¨ã€‚å¯é€‰è·¯ç”±è·¯å¾„å‰ç¼€ä¸º <code>users</code> ã€‚åœ¨ <code>@Controller()</code> è£…é¥°å™¨ä¸­ä½¿ç”¨è·¯å¾„å‰ç¼€å¯ä»¥å¯¹ä¸€ç»„ç›¸å…³çš„è·¯ç”±è¿›è¡Œåˆ†ç»„ï¼Œå¹¶æœ€å¤§ç¨‹åº¦çš„å‡å°‘é‡å¤ä»£ç ã€‚</p><h3 id="request" tabindex="-1"><a class="header-anchor" href="#request" aria-hidden="true">#</a> Request</h3><p>å¤„ç†ç¨‹åºæœ‰æ—¶éœ€è¦è®¿é—®å®¢æˆ·ç«¯çš„<strong>è¯·æ±‚</strong>ç»†èŠ‚ã€‚è¦è·å–è¯·æ±‚å¯¹è±¡ï¼Œåˆ™å¯ä»¥åœ¨å¤„ç†å‡½æ•°ä¸­ä½¿ç”¨ <code>@Req()</code> è£…é¥°å™¨ï¼Œå¦‚ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Req <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Request <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;express&quot;</span> <span class="token comment">// Nest é»˜è®¤çš„åº•å±‚å¹³å°æ˜¯ expressï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UsersController</span> <span class="token punctuation">{</span>
	<span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">findAll</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Req</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> request<span class="token operator">:</span> Request<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;è¿™é‡Œå¯ä»¥é€šè¿‡ request è®¿é—®è¯·æ±‚å¯¹è±¡æ¥è·å–è¯·æ±‚ç»†èŠ‚&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œåˆ—ä¸¾éƒ¨åˆ† Nest æä¾›çš„è·å–ç‰¹å®šå¯¹è±¡çš„è£…é¥°å™¨ï¼š</p><table><thead><tr><th>è£…é¥°å™¨</th><th>å¯¹è±¡</th></tr></thead><tbody><tr><td>@Request()ï¼Œ@Req()</td><td>req</td></tr><tr><td>@response()ï¼Œ@Res()</td><td>res</td></tr><tr><td>@Next()</td><td>next</td></tr><tr><td>@Session()</td><td>req.session</td></tr><tr><td>@Param(key?: string)</td><td>req.params[key?]</td></tr><tr><td>@Body(key?: string)</td><td>req.body[key?]</td></tr><tr><td>@Query(key?: string)</td><td>req.query[key?]</td></tr><tr><td>@Headers(name?: string)</td><td>req.headers[name?]</td></tr><tr><td>@Ip()</td><td>req.ip</td></tr><tr><td>@HostParam()</td><td>req.hosts</td></tr></tbody></table><h3 id="è·¯ç”±é€šé…ç¬¦" tabindex="-1"><a class="header-anchor" href="#è·¯ç”±é€šé…ç¬¦" aria-hidden="true">#</a> è·¯ç”±é€šé…ç¬¦</h3><p>è·¯ç”±ä¹Ÿæ”¯æŒæ¨¡å¼åŒ¹é…ï¼Œå¦‚ <code>*</code> è¢«ç”¨ä½œé€šé…ç¬¦ï¼Œå°†åŒ¹é…ä»»ä½•å­—ç¬¦ç»„åˆï¼Œå¦‚ï¼š<code>ab*cd</code> ä¼šåŒ¹é… <code>abcd | ab_cd | abecd| ...</code> ã€‚</p><p>å­—ç¬¦ <code>? | + | * | ()</code> æ˜¯å®ƒä»¬çš„æ­£åˆ™è¡¨è¾¾å¼å¯¹åº”é¡¹çš„å­é›†ã€‚è¿å­—ç¬¦ï¼ˆ<code>-</code>ï¼‰å’Œç‚¹ï¼ˆ<code>.</code>ï¼‰æŒ‰å­—ç¬¦ä¸²è·¯å¾„é€å­—è§£æã€‚</p><h3 id="çŠ¶æ€ç " tabindex="-1"><a class="header-anchor" href="#çŠ¶æ€ç " aria-hidden="true">#</a> çŠ¶æ€ç </h3><p>å¯ä»¥åœ¨å¤„ç†å‡½æ•°å¤–é€šè¿‡æ·»åŠ  <code>@HttpCode()</code> è£…é¥°å™¨æ¥æ›´æ”¹é»˜è®¤ç›¸åº”çš„çŠ¶æ€ç ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">HttpCode</span></span><span class="token punctuation">(</span><span class="token number">204</span><span class="token punctuation">)</span>
<span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&#39;è¿™ä¸ªè¯·æ±‚å“åº”çš„çŠ¶æ€ç ä¸º204&#39;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="headers" tabindex="-1"><a class="header-anchor" href="#headers" aria-hidden="true">#</a> Headers</h3><p>è¦æŒ‡å®šè‡ªå®šä¹‰å“åº”å¤´ï¼Œå¯ä»¥ä½¿ç”¨ <code>@Header()</code> è£…é¥°å™¨æˆ–ç±»åº“ç‰¹æœ‰çš„å“åº”å¯¹è±¡(<code>req.header()</code>)ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Header</span></span><span class="token punctuation">(</span><span class="token string">&#39;Cache-Control&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">)</span>
<span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&#39;è¿™ä¸ªè¯·æ±‚çš„å¤´ä¸º Cache-Control&#39;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><h5 id="æ³¨" tabindex="-1"><a class="header-anchor" href="#æ³¨" aria-hidden="true">#</a> æ³¨</h5><p><code>Header</code> éœ€è¦ä» <code>@nestjs/common</code> åŒ…å¯¼å…¥</p></blockquote><h3 id="é‡å®šå‘" tabindex="-1"><a class="header-anchor" href="#é‡å®šå‘" aria-hidden="true">#</a> é‡å®šå‘</h3><p>è¦å°†å“åº”é‡å®šå‘åˆ°ç‰¹å®šçš„ <code>URL</code> ï¼Œå¯ä»¥ä½¿ç”¨ <code>@Redirect()</code> è£…é¥°å™¨æˆ–ç‰¹å®šäºåº“çš„å“åº”å¯¹è±¡(<code>res.redirect()</code>)ã€‚</p><p><code>@Redirect()</code> æœ‰ä¸¤ä¸ªå¯é€‰å‚æ•°ï¼š<code>url</code> å’Œ <code>statusCode</code> ï¼ŒstatusCode é»˜è®¤ä¸º 302ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Redirect</span></span><span class="token punctuation">(</span><span class="token string">&#39;https://nestjs.com&#39;</span><span class="token punctuation">,</span> <span class="token number">301</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæƒ³è¦åŠ¨æ€çš„å†³å®šé‡å®šå‘ï¼Œåˆ™éœ€è¦é€šè¿‡ä»è·¯ç”±å¤„ç†æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹ä¸‹æ ¼å¼çš„å¯¹è±¡ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;statusCode&quot;</span><span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›çš„å€¼å°†è¦†ç›–ä¼ é€’ç»™ <code>@Redirect()</code> è£…é¥°å™¨çš„æ‰€æœ‰å‚æ•°ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Redirect</span></span><span class="token punctuation">(</span><span class="token string">&#39;https://doce.nestjs.com&#39;</span><span class="token punctuation">,</span> <span class="token number">302</span><span class="token punctuation">)</span>
<span class="token function">getDocs</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Query</span></span><span class="token punctuation">(</span><span class="token string">&#39;version&#39;</span><span class="token punctuation">)</span> version<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>version <span class="token operator">&amp;&amp;</span> version <span class="token operator">==</span> <span class="token string">&#39;5&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> url<span class="token operator">:</span> <span class="token string">&#39;https://doce.nestjs.com/v5/&#39;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å­åŸŸè·¯ç”±" tabindex="-1"><a class="header-anchor" href="#å­åŸŸè·¯ç”±" aria-hidden="true">#</a> å­åŸŸè·¯ç”±</h3><p>å­åŸŸè·¯ç”±ä¸è·¯ç”±å‰ç¼€ä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯é€šè¿‡å­åŸŸåè€Œéè·¯å¾„å‰ç¼€å¯¹åˆ†ç»„è·¯ç”±è¿›è¡Œçº¦æŸï¼Œä¸»è¦ç”¨æ¥åˆ¤æ–­è¿™ä¸ªæ§åˆ¶å™¨åœ¨è¢«è®¿é—®æ—¶ï¼Œé™åˆ¶å…·ä½“çš„åŸŸåæ¥è®¿é—®ã€‚</p><p><code>@Controller()</code> è£…é¥°å™¨æ¥å—ä¸€ä¸ª <code>host</code> é€‰é¡¹ï¼Œä»¥è¦æ±‚ä¼ å…¥è¯·æ±‚çš„ <code>HTTP</code> ä¸»æœºåŒ¹é…æŸä¸ªç‰¹å®šå€¼ã€‚è¯¥ <code>host</code> é€‰é¡¹å¯ä»¥ä½¿ç”¨å‚æ•°æ ‡è¯†æ¥æ•è·ä¸»æœºåä¸­è¯¥ä½ç½®çš„åŠ¨æ€å€¼ï¼Œå³æ•è·ä¸€ä¸ªäºŒçº§åŸŸåï¼Œå¯ä»¥ä½¿ç”¨ <code>@HostParam()</code> è£…é¥°å™¨è®¿é—®ä»¥è¿™ç§æ–¹å¼å£°æ˜çš„ä¸»æœºå‚æ•°ï¼Œæ¥è·å–è¿™ä¸ªäºŒçº§åŸŸåï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> host<span class="token operator">:</span> <span class="token string">&#39;:account.example.com&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> calss AccountCountroller <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">HostParam</span></span><span class="token punctuation">(</span><span class="token string">&#39;account&#39;</span><span class="token punctuation">)</span> account<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> account
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><h5 id="æ³¨-1" tabindex="-1"><a class="header-anchor" href="#æ³¨-1" aria-hidden="true">#</a> æ³¨</h5><p>ç”±äº<strong>Fastify</strong>ç¼ºä¹å¯¹åµŒå¥—è·¯ç”±å™¨çš„æ”¯æŒï¼Œå› æ­¤å½“ä½¿ç”¨å­åŸŸè·¯ç”±æ—¶ï¼Œåº”è¯¥æ”¹ç”¨<strong>express</strong>é€‚é…å™¨ã€‚</p></blockquote><h3 id="å¼‚æ­¥æ€§" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥æ€§" aria-hidden="true">#</a> å¼‚æ­¥æ€§</h3><p>Nest å°†è‡ªè¡Œè§£ææ¯ä¸ªå¼‚æ­¥å‡½æ•°è¿”å›çš„ Promiseã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤å¤–ï¼Œé€šè¿‡è¿”å› RxJS <a href="">observable æµ</a> ï¼ŒNest å°†è‡ªåŠ¨è®¢é˜…ä¸‹é¢çš„æºå¹¶è·å–æœ€åå‘å‡ºçš„å€¼ï¼ˆåœ¨æµå®Œæˆåï¼‰ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://zhuanlan.zhihu.com/p/110007033" target="_blank" rel="noopener noreferrer">ç®€å•å®ç°ä¸€ä¸ª observable<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://juejin.cn/post/7067851052841697310" target="_blank" rel="noopener noreferrer">åœ¨ TypeScript ä¸­ä½¿ç”¨ Observables æ¥è½¬æ¢æ•°æ®<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="æä¾›è€…-providers" tabindex="-1"><a class="header-anchor" href="#æä¾›è€…-providers" aria-hidden="true">#</a> æä¾›è€…ï¼šProviders</h2><p>Providers æ˜¯ <code>Nest</code> çš„ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µã€‚è®¸å¤šåŸºæœ¬çš„ <code>Nest</code> ç±»å¯èƒ½è¢«è§†ä¸º provider - <code>service | repository | factory | helper ç­‰ç­‰</code>ã€‚ ä»–ä»¬éƒ½å¯ä»¥é€šè¿‡ <code>constructor</code> <strong>æ³¨å…¥</strong>ä¾èµ–å…³ç³»ã€‚ è¿™æ„å‘³ç€å¯¹è±¡å¯ä»¥å½¼æ­¤åˆ›å»ºå„ç§å…³ç³»ï¼Œå¹¶ä¸”â€œè¿æ¥â€å¯¹è±¡å®ä¾‹çš„åŠŸèƒ½åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥å§”æ‰˜ç»™ <code>Nest</code>è¿è¡Œæ—¶ç³»ç»Ÿã€‚</p><p>Provider åªæ˜¯ä¸€ä¸ªç”¨ <code>@Injectable()</code> è£…é¥°å™¨æ³¨é‡Šçš„ç±»ã€‚</p><p><a href="https://docs.nestjs.cn/8/providers" target="_blank" rel="noopener noreferrer">å®Œæ•´æ–‡æ¡£é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="æœåŠ¡-service" tabindex="-1"><a class="header-anchor" href="#æœåŠ¡-service" aria-hidden="true">#</a> æœåŠ¡ï¼šService</h2><p><code>service</code>ï¼šæ˜¯ä¸€ç³»åˆ—æœåŠ¡ã€repoã€å·¥å‚æ–¹æ³•ã€helper çš„æ€»ç§°ï¼Œä¸»è¦è´Ÿè´£å¤„ç†å…·ä½“çš„ä¸šåŠ¡ï¼Œå¦‚<strong>æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ã€äº‹åŠ¡ã€å¹¶å‘ç­‰é€»è¾‘ä»£ç </strong>ã€‚å…¶ç”± <code>controller</code> ä½¿ç”¨ï¼Œå› æ­¤å°†å…¶å®šä¹‰ä¸ºä¸€ä¸ª <code>provider</code> æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚å› æ­¤ï¼Œä½¿ç”¨ <code>@Injectable()</code> æ¥è£…é¥°è¿™ä¸ªç±»ã€‚</p><h3 id="åˆ›å»º-service" tabindex="-1"><a class="header-anchor" href="#åˆ›å»º-service" aria-hidden="true">#</a> åˆ›å»º service</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>nest generate service
? What name would you like to use for the service? myService (è¿™æ˜¯serviceçš„åç§°ï¼Œå¯ä»¥éšä¾¿å¡«å†™)

// ç®€å†™
nest g s
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ„å»ºä¸€ä¸ª-service" tabindex="-1"><a class="header-anchor" href="#æ„å»ºä¸€ä¸ª-service" aria-hidden="true">#</a> æ„å»ºä¸€ä¸ª service</h3><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Cat <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./interfaces/cat.interface&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsService</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token keyword">readonly</span> cats<span class="token operator">:</span> Cat<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

	<span class="token function">create</span><span class="token punctuation">(</span>cat<span class="token operator">:</span> Cat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>cats<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Cat<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cats
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>interfaces/cat.interface</code>ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Cat</span> <span class="token punctuation">{</span>
	name<span class="token operator">:</span> <span class="token builtin">string</span>
	age<span class="token operator">:</span> <span class="token builtin">number</span>
	breed<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨-service" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-service" aria-hidden="true">#</a> ä½¿ç”¨ service</h3><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Body <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CreateCatDto <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./dto/create-cat.dto&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cats.service&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Cat <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./interfaces/cat.interface&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;cats&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsController</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> catsService<span class="token operator">:</span> CatsService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

	<span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Cat<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>/dto/create-cat.dto</code>ï¼šDTO(æ•°æ®ä¼ è¾“å¯¹è±¡)ï¼Œ<strong>æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ä¹‹é—´ä¼ è¾“æ•°æ®çš„è½¯ä»¶åº”ç”¨ç³»ç»Ÿã€‚æ•°æ®ä¼ è¾“ç›®æ ‡å¾€å¾€æ˜¯æ•°æ®è®¿é—®å¯¹è±¡ä»æ•°æ®åº“ä¸­æ£€ç´¢æ•°æ®ã€‚æ•°æ®ä¼ è¾“å¯¹è±¡ä¸æ•°æ®äº¤äº’å¯¹è±¡æˆ–æ•°æ®è®¿é—®å¯¹è±¡ä¹‹é—´çš„å·®å¼‚æ˜¯ä¸€ä¸ªä»¥ä¸å…·æœ‰ä»»ä½•è¡Œä¸ºé™¤äº†å­˜å‚¨å’Œæ£€ç´¢çš„æ•°æ®ï¼ˆè®¿é—®å’Œå­˜å–å™¨ï¼‰ã€‚</strong> åœ¨ Nest ä¸­ä½¿ç”¨ DTO ä¸€èˆ¬æ˜¯ä¸ºäº†é˜²æ­¢éæ³•å­—æ®µçš„æäº¤å’Œ IDE è‡ªåŠ¨æç¤ºã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ª DTO çš„ç»“æ„</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CreateCatDto</span> <span class="token punctuation">{</span>
	<span class="token keyword">readonly</span> name<span class="token operator">:</span> <span class="token builtin">string</span>
	<span class="token keyword">readonly</span> age<span class="token operator">:</span> <span class="token builtin">number</span>
	<span class="token keyword">readonly</span> breed<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾èµ–æ³¨å…¥" tabindex="-1"><a class="header-anchor" href="#ä¾èµ–æ³¨å…¥" aria-hidden="true">#</a> ä¾èµ–æ³¨å…¥</h3><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå°† <code>catsService</code> é€šè¿‡åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªå®ä¾‹æ¥è§£æ <code>CatsService</code> ã€‚è§£ææ­¤ä¾èµ–å…³ç³»å¹¶å°†å…¶ä¼ é€’ç»™æ§åˆ¶å™¨çš„æ„é€ å‡½æ•°ï¼ˆæˆ–åˆ†é…ç»™æŒ‡å®šçš„å±æ€§ï¼‰ï¼š</p><p><code>constructor(private readonly catsService: CatsService) {}</code></p><h2 id="æ¨¡å—-module" tabindex="-1"><a class="header-anchor" href="#æ¨¡å—-module" aria-hidden="true">#</a> æ¨¡å—ï¼šModule</h2><p>æ¨¡å—æ˜¯å…·æœ‰ <code>@Module()</code> è£…é¥°å™¨çš„ç±»ã€‚<code>@Module()</code> è£…é¥°å™¨æä¾›äº†å…ƒæ•°æ®ï¼ŒNest ç”¨å®ƒæ¥ç»„ç»‡åº”ç”¨ç¨‹åºç»“æ„ã€‚</p><p><a href="https://docs.nestjs.cn/8/modules" target="_blank" rel="noopener noreferrer">å®Œæ•´æ–‡æ¡£é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="åˆ›å»ºæ¨¡å—-module" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºæ¨¡å—-module" aria-hidden="true">#</a> åˆ›å»ºæ¨¡å— module</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>nest generate module myModule(è¿™æ˜¯æ¨¡å—å)

// ç®€å†™
nest g mo myModule
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¯ä¸ªæ¨¡å—åŒ…å«å››ä¸ªéƒ¨åˆ†ï¼š<code>controllers, exports, imports, providers</code></p><table><thead><tr><th>å±æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>providers</td><td>ç”± Nest æ³¨å…¥å™¨å®ä¾‹åŒ–çš„æä¾›è€…ï¼Œå¹¶ä¸”å¯ä»¥è‡³å°‘åœ¨æ•´ä¸ªæ¨¡å—ä¸­å…±äº«</td></tr><tr><td>controllers</td><td>å¿…é¡»åˆ›å»ºçš„ä¸€ç»„æ§åˆ¶å™¨</td></tr><tr><td>imports</td><td>å¯¼å…¥å…¶ä»–è¢« exports æš´éœ²å¤„ç†çš„æ¨¡å—</td></tr><tr><td>exports</td><td>è¡¨ç¤ºæœ¬æ¨¡å—ä¼šè¢«æš´éœ²å‡ºå»å¹¶å¯ä»¥è¢«å…¶ä»–æ¨¡å— imports å¯¼å…¥ä½¿ç”¨</td></tr></tbody></table><blockquote><h5 id="æ³¨-2" tabindex="-1"><a class="header-anchor" href="#æ³¨-2" aria-hidden="true">#</a> æ³¨ï¼š</h5><p>è¦æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„ controller ã€service ã€module åœ¨åˆ›å»ºçš„æ—¶å€™åå­—è¦ç›¸åŒï¼Œå¦‚è¦æ”¾åœ¨ /users è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œå¦‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>nest g co users // åˆ›å»º controller
nest g s users // åˆ›å»º service
nest g mo users // åˆ›å»º module
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>å½“æˆ‘ä»¬ä¸ºæ¯ä¸ªæ¨¡å—åˆ›å»ºäº†å…¶ module æ–‡ä»¶åï¼Œå³å¯åœ¨ <code>app.module.ts</code>æ–‡ä»¶ä¸­å¯¼å…¥ï¼Œå¹¶å°†å…¶æ”¾åœ¨<code>imports</code>æ•°ç»„ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥å»æ‰<code>controllers</code>å’Œ<code>providers</code>ä¸­å¯¼å…¥çš„è¿™ä¸ªæ¨¡å—çš„ controller å’Œ serviceï¼Œæ–¹ä¾¿ç®¡ç†æ–‡ä»¶ã€‚å¦‚ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* app.mudole.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./app.controller&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AppService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./app.service&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UsersModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./users/users.module&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	imports<span class="token operator">:</span> <span class="token punctuation">[</span>UsersModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
	controllers<span class="token operator">:</span> <span class="token punctuation">[</span>AppController<span class="token punctuation">]</span><span class="token punctuation">,</span>
	providers<span class="token operator">:</span> <span class="token punctuation">[</span>AppService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>moduleï¼šè´Ÿè´£å°† controller å’Œ service è¿æ¥èµ·æ¥ï¼Œç±»ä¼¼äº<code>namespace</code>çš„æ¦‚å¿µ</li></ul><h3 id="åŠŸèƒ½æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#åŠŸèƒ½æ¨¡å—" aria-hidden="true">#</a> åŠŸèƒ½æ¨¡å—</h3><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>CatsController</code> å’Œ <code>CatsService</code> å±äºåŒä¸€ä¸ªåº”ç”¨ç¨‹åºåŸŸä¸‹ï¼Œå› æ­¤ï¼Œåº”è¯¥å°†ä»–ä»¬ç§»åŠ¨åˆ°ä¸€ä¸ªåŠŸèƒ½æ¨¡å—ä¸‹ï¼Œå³ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* cats.module.ts */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cats.controller&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cats.service&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	controllers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsController<span class="token punctuation">]</span><span class="token punctuation">,</span>
	providers<span class="token operator">:</span> <span class="token punctuation">[</span>CatsService<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨åˆ›å»ºäº† cats çš„æ¨¡å—åï¼Œåº”å°†è¿™ä¸ªæ¨¡å—å¯¼å…¥æ ¹æ¨¡å—ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Module <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cats/cats.module&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	imports<span class="token operator">:</span> <span class="token punctuation">[</span>CatsModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationModule</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¾èµ–æ³¨å…¥-1" tabindex="-1"><a class="header-anchor" href="#ä¾èµ–æ³¨å…¥-1" aria-hidden="true">#</a> ä¾èµ–æ³¨å…¥</h3><p>å¯ä»¥å°† <code>service</code> æ³¨å…¥åˆ°æ¨¡å—ï¼ˆç±»ï¼‰ä¸­ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CatsModule</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> catsService<span class="token operator">:</span> CatsService<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åŠ¨æ€æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€æ¨¡å—" aria-hidden="true">#</a> åŠ¨æ€æ¨¡å—</h3><p>è¯¦æƒ…è§å®Œæ•´æ–‡æ¡£</p><h2 id="ä¸­é—´ä»¶-middleware" tabindex="-1"><a class="header-anchor" href="#ä¸­é—´ä»¶-middleware" aria-hidden="true">#</a> ä¸­é—´ä»¶ï¼šmiddleware</h2><p>ä¸­é—´ä»¶æ˜¯åœ¨è·¯ç”±å¤„ç†ç¨‹åºä¹‹å‰è°ƒç”¨çš„å‡½æ•°ï¼Œä¸­é—´ä»¶å‡½æ•°å¯ä»¥è®¿é—®è¯·æ±‚å’Œå“åº”å¯¹è±¡ï¼Œä»¥åŠåº”ç”¨ç¨‹åºè¯·æ±‚ç›¸åº”å‘¨æœŸä¸­çš„ <code>next()</code> å‡½æ•°ã€‚</p><p>Nest çš„ä¸­é—´ä»¶å®é™…ä¸Šç­‰ä»·äº express çš„ä¸­é—´ä»¶ã€‚</p><p><a href="https://docs.nestjs.cn/8/middlewares" target="_blank" rel="noopener noreferrer">å®Œæ•´æ–‡æ¡£é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="å®šä¹‰ä¸­é—´ä»¶" tabindex="-1"><a class="header-anchor" href="#å®šä¹‰ä¸­é—´ä»¶" aria-hidden="true">#</a> å®šä¹‰ä¸­é—´ä»¶</h3><p>Nest ä¸­é—´ä»¶å¯ä»¥åœ¨å‡½æ•°ä¸­æˆ–åœ¨å…·æœ‰ <code>@Injectable()</code> è£…é¥°å™¨çš„ç±»ä¸­å®ç°è‡ªå®šä¹‰ï¼Œè¢«è£…é¥°çš„å¯¹è±¡åº”è¯¥å®ç° <code>NestMiddleware</code> æ¥å£ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* logger.middleware.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> NestMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Request<span class="token punctuation">,</span> Response<span class="token punctuation">,</span> NextFunction <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;express&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LoggerMiddleware</span> <span class="token keyword">implements</span> <span class="token class-name">NestMiddleware</span> <span class="token punctuation">{</span>
	<span class="token function">use</span><span class="token punctuation">(</span>req<span class="token operator">:</span> Request<span class="token punctuation">,</span> res<span class="token operator">:</span> Response<span class="token punctuation">,</span> next<span class="token operator">:</span> NextFunction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;è¿™æ˜¯ä¸€ä¸ªä¸­é—´ä»¶&quot;</span><span class="token punctuation">)</span>
		<span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åº”ç”¨ä¸­é—´ä»¶" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨ä¸­é—´ä»¶" aria-hidden="true">#</a> åº”ç”¨ä¸­é—´ä»¶</h3><p>ä¸­é—´ä»¶ä¸èƒ½åœ¨ <code>@Module()</code> è£…é¥°å™¨ä¸­åˆ—å‡ºã€‚æˆ‘ä»¬å¿…é¡»ä½¿ç”¨æ¨¡å—ç±»çš„ <code>configure()</code> æ–¹æ³•æ¥è®¾ç½®ä¸­é—´ä»¶ã€‚åŒ…å«ä¸­é—´ä»¶çš„æ¨¡å—å¿…é¡»å®ç° <code>NestModule</code> æ¥å£ã€‚ä¸‹é¢çš„ä¾‹å­å°† LoggerMiddleware è®¾ç½®åœ¨ ApplicationModule å±‚ä¸Šã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* app.module.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Module<span class="token punctuation">,</span> NestModule<span class="token punctuation">,</span> MiddlewareConsumer<span class="token punctuation">,</span> RequestMethod <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> LoggerMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./common/middleware/logger.middleware&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cats/cats.module&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	imports<span class="token operator">:</span> <span class="token punctuation">[</span>CatsModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token keyword">implements</span> <span class="token class-name">NestModule</span> <span class="token punctuation">{</span>
	<span class="token function">configure</span><span class="token punctuation">(</span>consumer<span class="token operator">:</span> MiddlewareConsumer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">consumer</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>LoggerMiddleware<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forRoutes</span><span class="token punctuation">(</span><span class="token string">&quot;cats&quot;</span><span class="token punctuation">)</span>
		<span class="token comment">/*
    		ä¸Šé¢ä½¿ç”¨ forRoutes(&#39;cats&#39;) å°†è¿™ä¸ªä¸­é—´ä»¶æ–¹æ³•é™å®šåœ¨ cats è¿™ä¸ªæ¨¡å—ä¸­ä½¿ç”¨ï¼Œå¦‚æœæƒ³è¿›ä¸€æ­¥å°†å…¶é™åˆ¶åœ¨æŸä¸€ç±»è¯·æ±‚æ–¹æ³•åˆ™å¯ä»¥è¿™æ ·å†™ï¼š
    		forRoutes({ path: &#39;cats&#39;, method: RequestMethod.GET })
    		è¿™é‡Œå°†å…¶é™å®šåœ¨ GET è¯·æ±‚ï¼Œä¸Šé¢å¯¼å…¥äº† RequestMethodï¼Œ
    		è¿™é‡Œçš„ path è·¯å¾„ä¹Ÿå¯ä»¥ä½¿ç”¨è·¯ç”±é€šé…ç¬¦ï¼Œè¯¦æƒ…è§å®Œæ•´æ–‡æ¡£
    	*/</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>å¯ä»¥ä½¿ç”¨ <code>async/await</code>æ¥å®ç° <code>configure()</code>æ–¹æ³•çš„å¼‚æ­¥åŒ–(ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨ <code>configure()</code>æ–¹æ³•ä½“ä¸­ç­‰å¾…å¼‚æ­¥æ“ä½œçš„å®Œæˆ)ã€‚</p></blockquote><h3 id="ä¸­é—´ä»¶æ¶ˆè´¹è€…" tabindex="-1"><a class="header-anchor" href="#ä¸­é—´ä»¶æ¶ˆè´¹è€…" aria-hidden="true">#</a> ä¸­é—´ä»¶æ¶ˆè´¹è€…</h3><p><code>MiddlewareConsummer</code> æ˜¯ä¸€ä¸ªå¸®åŠ©ç±»ï¼Œå®ƒæä¾›äº†å‡ ç§å†…ç½®æ–¹æ³•æ¥ç®¡ç†ä¸­é—´ä»¶ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥é“¾å¼è°ƒç”¨ã€‚</p><p><code>forRoutes()</code> å¯æ¥å—ä¸€ä¸ª or å¤šä¸ªå­—ç¬¦ä¸²ã€å¯¹è±¡ã€ä¸€ä¸ª or å¤šä¸ªæ§åˆ¶å™¨ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* app.module.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Module<span class="token punctuation">,</span> NestModule<span class="token punctuation">,</span> MiddlewareConsumer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> LoggerMiddleware <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./common/middleware/logger.middleware&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cats/cats.module&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CatsController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./cats/cats.controller.ts&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	imports<span class="token operator">:</span> <span class="token punctuation">[</span>CatsModele<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token keyword">implements</span> <span class="token class-name">NestModule</span> <span class="token punctuation">{</span>
	<span class="token function">configure</span><span class="token punctuation">(</span>consumer<span class="token operator">:</span> MiddlewareConsumer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">consumer</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>LoggerMiddleware<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forRoutes</span><span class="token punctuation">(</span>CatsController<span class="token punctuation">)</span>
		<span class="token comment">// apply() æ–¹æ³•å¯ä»¥ä½¿ç”¨å•ä¸ªä¸­é—´ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¤šä¸ªå‚æ•°æ¥æŒ‡å®šå¤šä¸ªä¸­é—´ä»¶</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæƒ³æ’é™¤æŸäº›è·¯ç”±ä½¿ç”¨ä¸­é—´ä»¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>exclude()</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥é‡‡ç”¨ä¸€ä¸ª or å¤šä¸ªå­—ç¬¦ä¸²ã€ä¸€ä¸ª<strong>RouteInfo</strong>å¯¹è±¡æ¥æ ‡è¯†è¦æ’é™¤çš„è·¯ç”±ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token function">consumer</span>
	<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>LoggerMiddleware<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">exclude</span><span class="token punctuation">(</span>
		<span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">&quot;cats&quot;</span><span class="token punctuation">,</span> method<span class="token operator">:</span> RequestMethod<span class="token punctuation">.</span><span class="token constant">GET</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">&quot;cats&quot;</span><span class="token punctuation">,</span> method<span class="token operator">:</span> RequestMethod<span class="token punctuation">.</span>Post <span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string">&quot;cats/(.*)&quot;</span> <span class="token comment">// è¯¥ exclude() æ–¹æ³•ä½¿ç”¨ path-to-regexp åŒ…æ”¯æŒé€šé…ç¬¦å‚æ•°ã€‚</span>
	<span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">forRoutes</span><span class="token punctuation">(</span>CatsController<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="å‡½æ•°å¼ä¸­é—´ä»¶" tabindex="-1"><a class="header-anchor" href="#å‡½æ•°å¼ä¸­é—´ä»¶" aria-hidden="true">#</a> å‡½æ•°å¼ä¸­é—´ä»¶</h3><p>å¦‚æœå®šä¹‰çš„ä¸­é—´ä»¶éå¸¸ç®€å•ï¼Œæ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»ã€æˆå‘˜ã€æ–¹æ³•ç­‰ï¼Œå¦‚ä¸Šé¢çš„ LoggerMiddleware ï¼Œåˆ™å¯ä»¥å°†å…¶å®šä¹‰ä¸ºä¸€ä¸ªå‡½æ•°å¼ä¸­é—´ä»¶ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* logger.middleware.ts */</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">logger</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;è¿™æ˜¯ä¸€ä¸ªå‡½æ•°å¼ä¸­é—´ä»¶&quot;</span><span class="token punctuation">)</span>
	<span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>ä½¿ç”¨å‡½æ•°å¼ä¸­é—´ä»¶ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* app.module.ts */</span>

<span class="token function">consumer</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forRoutes</span><span class="token punctuation">(</span>CatsController<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="å¤šä¸ªä¸­é—´ä»¶" tabindex="-1"><a class="header-anchor" href="#å¤šä¸ªä¸­é—´ä»¶" aria-hidden="true">#</a> å¤šä¸ªä¸­é—´ä»¶</h3><p>è¦ç»‘å®šé¡ºåºæ‰§è¡Œå¤šä¸ªä¸­é—´ä»¶ï¼Œå¯ä»¥åœ¨ <code>apply()</code> æ–¹æ³•å†…ç”¨ <code>,</code> åˆ†éš”è¿™äº›ä¸­é—´ä»¶ï¼š</p><p><code>consumer.apply(cors(), helmet(), logger).forRoutes(CatsController)</code></p><h3 id="å…¨å±€ä¸­é—´ä»¶" tabindex="-1"><a class="header-anchor" href="#å…¨å±€ä¸­é—´ä»¶" aria-hidden="true">#</a> å…¨å±€ä¸­é—´ä»¶</h3><p>å¦‚æœè¦å°†ä¸­é—´ä»¶ç»‘å®šåˆ°æ¯ä¸ªè·¯ç”±ä¸Šï¼Œå¦‚ä¸‹ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span>
<span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å¼‚å¸¸è¿‡æ»¤å™¨" tabindex="-1"><a class="header-anchor" href="#å¼‚å¸¸è¿‡æ»¤å™¨" aria-hidden="true">#</a> å¼‚å¸¸è¿‡æ»¤å™¨</h2><p>å†…ç½®çš„<strong>å¼‚å¸¸å±‚</strong>è´Ÿè´£å¤„ç†æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰æŠ›å‡ºçš„å¼‚å¸¸ã€‚</p><p>è¿‡æ»¤æ“ä½œç”±å†…ç½®çš„å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨æ‰§è¡Œï¼Œè¯¥è¿‡æ»¤å™¨å¤„ç†ç±»å‹ <code>HttpException</code> (åŠå…¶å­ç±») çš„å¼‚å¸¸ã€‚å½“æŸä¸ªå¼‚å¸¸æ— æ³•è¢«å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨è¯†åˆ«æ—¶ï¼Œç”¨æˆ·å°†æ”¶åˆ°ä»¥ä¸‹å“åº”ï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;statusCode&quot;</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
	<span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Internal server error&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://docs.nestjs.cn/8/exceptionfilters" target="_blank" rel="noopener noreferrer">å®Œæ•´æ–‡æ¡£é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="åŸºç¡€å¼‚å¸¸ç±»" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€å¼‚å¸¸ç±»" aria-hidden="true">#</a> åŸºç¡€å¼‚å¸¸ç±»</h3><p>Nest æä¾›äº†ä¸€ä¸ªå†…ç½®çš„ <code>HttpException</code> ç±»ï¼Œä» <code>@nestjs/common</code> åŒ…ä¸­å¯¼å…¥ã€‚</p><p>å‡è®¾ç›®å‰æœ‰ä¸€ä¸ªå¼‚å¸¸ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* cats.controller.ts */</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">HttpException</span><span class="token punctuation">(</span><span class="token string">&#39;Forbidden&#39;</span><span class="token punctuation">,</span> HttpStatus<span class="token punctuation">.</span><span class="token constant">FORBIDDEN</span><span class="token punctuation">)</span>
  <span class="token comment">// HttpStatus æ˜¯ä» @nestjs/common åŒ…ä¸­å¯¼å…¥çš„è¾…åŠ©æšä¸¾å™¨</span>
 	<span class="token comment">/* è¿™é‡Œçš„è¿”å›ç»“æœä¸ºï¼š
 		{
 			&quot;statusCode&quot;: 403,
 			&quot;message&quot;: &quot;Forbidden&quot;
 		}
 	*/</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>HttpException</code> æ„é€ å‡½æ•°æœ‰ä¸¤ä¸ªå¿…è¦çš„å‚æ•°æ¥å†³å®šå“åº”ï¼š</p><ul><li>responseï¼šå®šä¹‰ JSON å“åº”ä½“ï¼Œå¯ä»¥æ˜¯ string æˆ–è€… objectï¼Œå½“åªä¼ å…¥ä¸€ä¸ª string æ—¶ï¼Œåªè¦†ç›– JSON ç›¸åº”ä¸»ä½“çš„ message</li><li>statusï¼šçŠ¶æ€ç ï¼Œå¯ä»¥è‡ªå·±å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ HttpStatus ç±»ä¸­å±æ€§</li></ul><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒJSON å“åº”ä¸»ä½“åŒ…å«ä¸¤ä¸ªå±æ€§ï¼š</p><ul><li>statusCodeï¼šé»˜è®¤ä¸º status å‚æ•°ä¸­æä¾›çš„çŠ¶æ€ç </li><li>messageï¼šé”™è¯¯çš„ç®€çŸ­æè¿°</li></ul><h3 id="è‡ªå®šä¹‰å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰å¼‚å¸¸" aria-hidden="true">#</a> è‡ªå®šä¹‰å¼‚å¸¸</h3><p>è‡ªå®šä¹‰å¼‚å¸¸ç»§æ‰¿è‡ª <code>HttpException</code> ç±»ï¼Œè¿™æ · Nest å¯ä»¥è‡ªåŠ¨è¯†åˆ«å¼‚å¸¸ï¼Œå¹¶å¤„ç†é”™è¯¯å“åº”ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* forbidden.exception.ts */</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ForbiddenException</span> <span class="token keyword">extends</span> <span class="token class-name">HttpException</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span><span class="token string">&quot;Forbidden&quot;</span><span class="token punctuation">,</span> HttpStatus<span class="token punctuation">.</span><span class="token constant">FORBIDDEN</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>ä½¿ç”¨</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* cats.controller.ts */</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ForbiddenException</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="å†…ç½®-http-å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#å†…ç½®-http-å¼‚å¸¸" aria-hidden="true">#</a> å†…ç½® HTTP å¼‚å¸¸</h3><p>Nest æä¾›äº†ä¸€ç³»åˆ—ç»§æ‰¿è‡ªæ ¸å¿ƒå¼‚å¸¸ <code>HttpException</code> çš„å¯ç”¨å¼‚å¸¸ï¼Œä½¿ç”¨æ—¶ç›´æ¥ <code>throw new XXX(æè¿°, çŠ¶æ€)</code> ï¼Œå®ƒä»¬éƒ½å¯ä»¥ä» <code>@nestjs/common</code> åŒ…ä¸­å¯¼å…¥ï¼Œæ¯ä¸ªå¼‚å¸¸æŠ›å‡ºçš„çŠ¶æ€ç ä¸åŒï¼š</p><p><img src="/docs/assets/image-20220927094558749-0f761624.png" alt="image-20220927094558749"></p><h3 id="å¼‚å¸¸è¿‡æ»¤å™¨-1" tabindex="-1"><a class="header-anchor" href="#å¼‚å¸¸è¿‡æ»¤å™¨-1" aria-hidden="true">#</a> å¼‚å¸¸è¿‡æ»¤å™¨</h3><p>å¼‚å¸¸è¿‡æ»¤å™¨å¯ä»¥æ›´åŠ ç²¾ç¡®çš„å°†å“åº”çš„å†…å®¹å‘å›ç»™å®¢æˆ·ç«¯ï¼Œæˆ–è€…åšä¸€äº›æ›´åŠ ç²¾ç»†çš„å·¥ä½œï¼Œå¦‚æ·»åŠ æ—¥å¿—è®°å½•æˆ–åŸºäºä¸€äº›åŠ¨æ€å› ç´ ä½¿ç”¨å…¶ä»– JSON æ¨¡å¼ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* http-exception.filter.ts */</span>

<span class="token comment">// æ‰€æœ‰çš„å¼‚å¸¸è¿‡æ»¤å™¨éƒ½åº”è¯¥å®ç°é€šç”¨çš„ ExceptionFilter&lt;T&gt; æ¥å£ï¼Œéœ€è¦ä½¿ç”¨</span>
<span class="token comment">// catch(exception: T, host: ArgumentsHost) æ–¹æ³•ï¼ŒT è¡¨ç¤ºå¼‚å¸¸çš„ç±»å‹</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ExceptionFilter<span class="token punctuation">,</span> Catch<span class="token punctuation">,</span> ArgumentsHost<span class="token punctuation">,</span> HttpException <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token comment">// å¯¼å…¥ Request å’Œ Response ï¼Œåˆ†åˆ«ç”¨æ¥è·å–è¯·æ±‚ä¿¡æ¯å’Œæ§åˆ¶å“åº”</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Request<span class="token punctuation">,</span> Response <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;express&quot;</span>

<span class="token comment">// @Catch() è£…é¥°å™¨ç»‘å®šæ‰€éœ€çš„å…ƒæ•°æ®åˆ°å¼‚å¸¸è¿‡æ»¤å™¨ä¸Šï¼Œå®ƒå‘ŠçŸ¥ Nest è¿™ä¸ªç‰¹å®šçš„è¿‡æ»¤å™¨è¦</span>
<span class="token comment">// å¯»æ‰¾å“ªä¸€ç±»å¼‚å¸¸ã€‚</span>
<span class="token comment">// @Catch() å¯ä»¥ä¼ é€’å¤šä¸ªå‚æ•°ï¼Œé€šè¿‡é€—å·éš”å¼€ï¼Œè¿™æ ·å¯ä»¥ç»™å¤šä¸ªç±»å‹çš„å¼‚å¸¸è®¾ç½®è¿‡æ»¤å™¨</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Catch</span></span><span class="token punctuation">(</span>HttpException<span class="token punctuation">)</span>
<span class="token comment">// åˆ›å»ºä¸€ä¸ªå¼‚å¸¸è¿‡æ»¤å™¨ï¼Œè´Ÿè´£æ•è·ä½œä¸º HttpException ç±»å®ä¾‹çš„å¼‚å¸¸</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">HttpExceptionFilter</span> <span class="token keyword">implements</span> <span class="token class-name">ExceptionFilter</span> <span class="token punctuation">{</span>
	<span class="token comment">// exceptionï¼šå½“å‰æ­£åœ¨å¤„ç†çš„å¼‚å¸¸å¯¹è±¡</span>
	<span class="token comment">// hostï¼šä¼ é€’ç»™åŸå§‹å¤„ç†ç¨‹åºçš„å‚æ•°çš„ä¸€ä¸ªåŒ…è£…ï¼ˆResponse/Requestï¼‰çš„å¼•ç”¨</span>
	<span class="token keyword">catch</span><span class="token punctuation">(</span>exception<span class="token operator">:</span> HttpException<span class="token punctuation">,</span> host<span class="token operator">:</span> ArgumentsHost<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> ctx <span class="token operator">=</span> host<span class="token punctuation">.</span><span class="token function">switchToHttp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">const</span> response <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">getResponse</span><span class="token generic class-name"><span class="token operator">&lt;</span>Response<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">const</span> request <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">getRequest</span><span class="token generic class-name"><span class="token operator">&lt;</span>Request<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">const</span> status <span class="token operator">=</span> exception<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">const</span> message <span class="token operator">=</span> exception<span class="token punctuation">.</span>message <span class="token operator">||</span> exception<span class="token punctuation">.</span>message<span class="token punctuation">.</span>message <span class="token operator">||</span> exception<span class="token punctuation">.</span>message<span class="token punctuation">.</span>error <span class="token operator">||</span> <span class="token keyword">null</span>

		<span class="token comment">// ä½¿ç”¨ Response.json() æ–¹æ³•ï¼Œä½¿ç”¨ Response å¯¹è±¡ç›´æ¥æ§åˆ¶å‘é€çš„å“åº”</span>
		response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			statusCode<span class="token operator">:</span> status<span class="token punctuation">,</span> <span class="token comment">// ç³»ç»Ÿé”™è¯¯çŠ¶æ€</span>
			timestamp<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// é”™è¯¯æ—¥æœŸ</span>
			path<span class="token operator">:</span> request<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token comment">// é”™è¯¯è·¯ç”±</span>
			message<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token comment">// é”™è¯¯ä¿¡æ¯</span>
			data<span class="token operator">:</span> message<span class="token punctuation">,</span> <span class="token comment">// é”™è¯¯æ¶ˆæ¯çš„å…·ä½“å†…å®¹</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>ä½¿ç”¨</p><ol><li><p>å…¨å±€ä½¿ç”¨ï¼šåœ¨ <code>main.ts</code> ä¸­å¯¼å…¥éœ€è¦çš„æ¨¡å—ï¼Œä½†åä½¿ç”¨ <code>app.useGlobalFilters(new HttpExceptionFilter())</code> å³å¯</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* main.ts */</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
  app<span class="token punctuation">.</span><span class="token function">useGlobalFilters</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpExceptionFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  wait app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ¨¡å—ä½¿ç”¨ï¼šåœ¨éœ€è¦ä½¿ç”¨çš„ controller ä¸­å¯¼å…¥æ¨¡å—ï¼Œç„¶åä» <code>@nestjs/common</code> ä¸­å¯¼å…¥ <code>UseFilters</code> è£…é¥°å™¨ï¼Œæœ€åå°†å…¶æ”¾åœ¨å¯¹åº”çš„ <code>@Controller()</code> æˆ–è€… <code>@Get() | @Post() | ...</code> ä¹‹ä¸‹å³å¯</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* cats.controller.ts */</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// UseFilters å¯ä»¥ä½¿ç”¨å•ä¸ªè¿‡æ»¤å™¨ï¼Œä¹Ÿå¯ä»¥ç”¨é€—å·åˆ†éš”å¤šä¸ªè¿‡æ»¤å™¨</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">UseFilters</span></span><span class="token punctuation">(</span>HttpExceptionFilter<span class="token punctuation">)</span>
<span class="token comment">// @UseFilters(new HttpExceptionFilter()) ä¸¤ç§å†™æ³•éƒ½å¯ä»¥</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ForbiddenException</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></li></ul><h3 id="æ•è·æ‰€æœ‰å¼‚å¸¸" tabindex="-1"><a class="header-anchor" href="#æ•è·æ‰€æœ‰å¼‚å¸¸" aria-hidden="true">#</a> æ•è·æ‰€æœ‰å¼‚å¸¸</h3><p>ä¸ºäº†æ•è·æ¯ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸ï¼Œä¸è®ºç±»å‹ï¼Œå³å¯å°† <code>@Catch()</code> å‚æ•°åˆ—è¡¨è®¾ä¸ºç©º</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ExceptionFilter<span class="token punctuation">,</span> Catch<span class="token punctuation">,</span> ArgumentsHost<span class="token punctuation">,</span> HttpException<span class="token punctuation">,</span> HttpStatus <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Catch</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AllExceptionsFilter</span> <span class="token keyword">implements</span> <span class="token class-name">ExceptionFilter</span> <span class="token punctuation">{</span>
	<span class="token function">catch</span><span class="token punctuation">(</span>exception<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">,</span> host<span class="token operator">:</span> ArgumentsHost<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> ctx <span class="token operator">=</span> host<span class="token punctuation">.</span><span class="token function">switchToHttp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">const</span> response <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">const</span> request <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">const</span> status <span class="token operator">=</span> exception <span class="token keyword">instanceof</span> <span class="token class-name">HttpException</span> <span class="token operator">?</span> exception<span class="token punctuation">.</span><span class="token function">getStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> HttpStatus<span class="token punctuation">.</span><span class="token constant">INTERNAL_SERVER_ERROR</span>

		response<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			statusCode<span class="token operator">:</span> status<span class="token punctuation">,</span>
			timestamp<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			path<span class="token operator">:</span> request<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ç®¡é“" tabindex="-1"><a class="header-anchor" href="#ç®¡é“" aria-hidden="true">#</a> ç®¡é“</h2><p>Nest ä½¿ç”¨ <code>@Injectable()</code> è£…é¥°å™¨è£…é¥°ç®¡é“ï¼Œç®¡é“åº”å®ç° <code>PipeTransform</code> æ¥å£</p><p>ç®¡é“æœ‰ä¸¤ä¸ªä½œç”¨ï¼š</p><ul><li>è½¬æ¢ï¼šç®¡é“å°†è¾“å…¥æ•°æ®è½¬æ¢ä¸ºæ‰€éœ€çš„æ•°æ®è¾“å‡º</li><li>éªŒè¯ï¼šå¯¹è¾“å…¥çš„æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œå¦‚æœéªŒè¯æˆåŠŸåˆ™ç»§ç»­ä¼ é€’ï¼Œå¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸</li></ul><p><code>æ‰§è¡Œé¡ºåºï¼šå®¢æˆ·ç«¯è¯·æ±‚-&gt;ä¸­é—´ä»¶-&gt;è·¯ç”±å®ˆå«-&gt;ç®¡é“-&gt;æ§åˆ¶å™¨æ–¹æ³•</code></p><p><a href="https://docs.nestjs.cn/8/pipes" target="_blank" rel="noopener noreferrer">å®Œæ•´æ–‡æ¡£é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="å†…ç½®ç®¡é“" tabindex="-1"><a class="header-anchor" href="#å†…ç½®ç®¡é“" aria-hidden="true">#</a> å†…ç½®ç®¡é“</h3><p>Nest æœ‰å…­ä¸ªå†…ç½®çš„ç®¡é“ï¼Œå®ƒä»¬éƒ½ä» <code>@nestjs/common</code> åŒ…ä¸­å¯¼å…¥ï¼š</p><ul><li><code>ValidationPipe</code></li><li><code>ParseIntPipe</code></li><li><code>ParseBoolPipe</code></li><li><code>ParseArrayPipe</code></li><li><code>ParseUUIDPipe</code></li><li><code>DefaultValuePipe</code></li></ul><h3 id="å¼€å‘ä¸€ä¸ªç®¡é“" tabindex="-1"><a class="header-anchor" href="#å¼€å‘ä¸€ä¸ªç®¡é“" aria-hidden="true">#</a> å¼€å‘ä¸€ä¸ªç®¡é“</h3><p>è¦äº†è§£ä¸Šé¢è¿™å‡ ä¸ªå†…ç½®ç®¡é“å¦‚ä½•å·¥ä½œï¼Œè¿™é‡Œä»¥ <code>ValidationPipe</code> ä¸ºä¾‹æ¥æ„å»ºï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* validate.pipe.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> PipeTransform<span class="token punctuation">,</span> Injectable<span class="token punctuation">,</span> ArgumentMetadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ValidationPipe</span> <span class="token keyword">implements</span> <span class="token class-name">PipeTransform</span> <span class="token punctuation">{</span>
	<span class="token function">transform</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> metadata<span class="token operator">:</span> ArgumentMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> value
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>PipeTransform&lt;T, R&gt;</code> æ˜¯ä¸€ä¸ªé€šç”¨æ¥å£ï¼Œå…¶ä¸­ T è¡¨ç¤º value çš„ç±»å‹ï¼ŒR è¡¨ç¤º transform() æ–¹æ³•çš„è¿”å›ç±»å‹ã€‚</p><p>æ¯ä¸ªç®¡é“éƒ½å¿…é¡»æä¾› <code>transform(value, metadata)</code> æ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªå‚æ•°åˆ†åˆ«è¡¨ç¤ºï¼š</p><ul><li>valueï¼šå½“å‰å¤„ç†çš„å‚æ•°</li><li>metadataï¼šå…ƒæ•°æ®</li></ul><p><code>value(å³ArgumentMetadata)</code> å®šä¹‰å¦‚ä¸‹ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ArgumentMetadata</span> <span class="token punctuation">{</span>
	<span class="token keyword">readonly</span> type<span class="token operator">:</span> <span class="token string">&quot;body&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;query&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;param&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;custom&quot;</span> <span class="token comment">// è¾“å…¥æ•°æ®çš„æ¥æº</span>
	<span class="token keyword">readonly</span> metatype<span class="token operator">?</span><span class="token operator">:</span> Type<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token comment">// æ³¨å…¥æ•°æ®çš„ç±»å‹</span>
	<span class="token keyword">readonly</span> data<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token comment">// ä¼ é€’ç»™è£…é¥°å™¨çš„æ•°æ®ç±»å‹</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚ä¸‹é¢è¿™ä¸ªæ§åˆ¶å™¨æ–¹æ³•ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">login</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Query</span></span><span class="token punctuation">(</span><span class="token string">&#39;num&#39;</span><span class="token punctuation">)</span> num<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token comment">// è¿™ä¸ªæ–¹æ³•çš„å…ƒæ•°æ®å¦‚ä¸‹ï¼š</span>
<span class="token comment">// typeï¼šquery</span>
<span class="token comment">// metatypeï¼šNumber</span>
<span class="token comment">// dataï¼šnum</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><h3 id="å¯¹è±¡ç»“æ„éªŒè¯" tabindex="-1"><a class="header-anchor" href="#å¯¹è±¡ç»“æ„éªŒè¯" aria-hidden="true">#</a> å¯¹è±¡ç»“æ„éªŒè¯</h3><p>ä¸€ç§å¸¸è§çš„éªŒè¯æ–¹å¼æ˜¯ä½¿ç”¨åŸºäºç»“æ„çš„éªŒè¯ï¼Œ<a href="https://github.com/hapijs/joi" target="_blank" rel="noopener noreferrer">Joi<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> åº“å…è®¸ä½¿ç”¨ä¸€ä¸ªå¯è¯»çš„ API çš„æ–¹å¼åˆ›å»º schemaã€‚</p><ol><li><p>å®‰è£…ä¾èµ–</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ npm install --save @hapi/joi
$ npm install --save-dev @types/hapi__joi
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä½¿ç”¨ Joi æ„å»ºç®¡é“</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> PipeTransform<span class="token punctuation">,</span> Injectable<span class="token punctuation">,</span> ArgumentMetadata<span class="token punctuation">,</span> BadRequestException <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ObjectSchema <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@hapi/joi&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">JoiValidationPipe</span> <span class="token keyword">implements</span> <span class="token class-name">PipeTransform</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> schema<span class="token operator">:</span> ObjectSchema<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

	<span class="token function">trnasform</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> metadata<span class="token operator">:</span> ArgumentMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// ä½¿ç”¨ joi æä¾›çš„ validate() æ–¹æ³•éªŒè¯</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>schema<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BadRequestException</span><span class="token punctuation">(</span><span class="token string">&quot;Validation failed&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> value
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä½¿ç”¨è¿™ä¸ªç®¡é“</p><p>å¯ä»¥åœ¨ controller æˆ–è€…å®ƒçš„æ–¹æ³•ä¸Šä½¿ç”¨ï¼Œä½¿ç”¨ <code>@UsePipes()</code> è£…é¥°å™¨å¹¶åˆ›å»ºä¸€ä¸ªç®¡é“å®ä¾‹ï¼Œå°†å…¶ä¼ é€’ç»™ Joi éªŒè¯ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">UsePipes</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JoiValidationPipe</span><span class="token punctuation">(</span>createCatSchema<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="class-validator" tabindex="-1"><a class="header-anchor" href="#class-validator" aria-hidden="true">#</a> class-validator</h3><p>å¦‚æœä½¿ç”¨åŸå§‹çš„ JavaScript å¼€å‘åº”ç”¨ï¼Œåˆ™è¿™ä¸ªåŠŸèƒ½æ— æ³•ä½¿ç”¨ï¼Œéœ€è¦ä½¿ç”¨ TypeScript ã€‚</p><p>Nest å¯ä»¥ä¸ <a href="https://github.com/typestack/class-validator" target="_blank" rel="noopener noreferrer">class-validator<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æ­é…ä½¿ç”¨ï¼Œè¿™ä¸ªåº“å…è®¸æˆ‘ä»¬ä½¿ç”¨åŸºäºè£…é¥°å™¨çš„éªŒè¯ã€‚</p><ol><li><p>å®‰è£…ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ npm i --save class-validator class-transformer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>å‘ CreateCatDto ç±»ä¸­æ·»åŠ è£…é¥°å™¨ï¼š<a href="https://github.com/typestack/class-validator#validation-decorators" target="_blank" rel="noopener noreferrer">æ›´å¤šè£…é¥°å™¨ä¿¡æ¯<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* create-cat.dto.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> IsString<span class="token punctuation">,</span> IsInt <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;class-validator&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CreateCatDto</span> <span class="token punctuation">{</span>
	<span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	name<span class="token operator">:</span> <span class="token builtin">string</span>

	<span class="token decorator"><span class="token at operator">@</span><span class="token function">IsInt</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	age<span class="token operator">:</span> <span class="token builtin">number</span>

	<span class="token decorator"><span class="token at operator">@</span><span class="token function">IsString</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	breed<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åˆ›å»ºä¸€ä¸ªç®¡é“ï¼šValidationPipe ç±»</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* validate.pipe.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> PipeTransform<span class="token punctuation">,</span> Injectable<span class="token punctuation">,</span> ArgumentMetadata<span class="token punctuation">,</span> BadRequestException <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> validate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;class-validator&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> plainToClass <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;class-transformer&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ValidationPipe</span> <span class="token keyword">implements</span> <span class="token class-name">PipeTransform<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token comment">// è¿™é‡Œçš„ transform() æ˜¯å¼‚æ­¥çš„ï¼Œå› ä¸º class-validator å¯ä»¥éªŒè¯ promise</span>
	<span class="token keyword">async</span> <span class="token function">transform</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> metatype <span class="token punctuation">}</span><span class="token operator">:</span> ArgumentMetadata<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// ä½¿ç”¨ toValidate() æ–¹æ³•éªŒè¯ç±»å‹æ˜¯ä¸æ˜¯ JavaScript çš„æ•°æ®ç±»å‹</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>metatype <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toValidate</span><span class="token punctuation">(</span>metatype<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> value
		<span class="token punctuation">}</span>

		<span class="token comment">// ä½¿ç”¨ class-transformer çš„ plainToClass() æ–¹æ³•æ¥è½¬æ¢å‚æ•°ä¸ºå¯éªŒè¯çš„ç±»å‹å¯¹è±¡</span>
		<span class="token comment">// class-validator éœ€è¦ä½¿ç”¨å‰é¢å®šä¹‰çš„ DTO ï¼Œå°±éœ€è¦åšä¸€ä¸ªç±»å‹è½¬æ¢ã€‚</span>
		<span class="token keyword">const</span> object <span class="token operator">=</span> <span class="token function">plainToClass</span><span class="token punctuation">(</span>metatype<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
		<span class="token keyword">const</span> errors <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">validate</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>errors<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BadRequestExceotion</span><span class="token punctuation">(</span><span class="token string">&quot;validation failed&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> value
	<span class="token punctuation">}</span>

	<span class="token keyword">private</span> <span class="token function">toValidate</span><span class="token punctuation">(</span>metatype<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> types<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>String<span class="token punctuation">,</span> Boolean<span class="token punctuation">,</span> Number<span class="token punctuation">,</span> <span class="token builtin">Array</span><span class="token punctuation">,</span> Object<span class="token punctuation">]</span>
		<span class="token keyword">return</span> <span class="token operator">!</span>type<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>metatype<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä½¿ç”¨ç®¡é“</p><ul><li><p>å‚æ•°èŒƒå›´ä½¿ç”¨</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* cats.controller.ts */</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValidationPipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ–¹æ³•èŒƒå›´ä½¿ç”¨</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* cats.controller.ts */</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">UsePipes</span></span><span class="token punctuation">(</span>ValidationPipe<span class="token punctuation">)</span>
<span class="token comment">// @UsePipes(new ValidationPipe())</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å…¨å±€èŒƒå›´ä½¿ç”¨</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* main.ts */</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">useGlobalPipes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValidationPipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="è½¬æ¢é€šé“" tabindex="-1"><a class="header-anchor" href="#è½¬æ¢é€šé“" aria-hidden="true">#</a> è½¬æ¢é€šé“</h3><p>æœ‰æ—¶ä»å®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„æ•°æ®éœ€è¦ç»è¿‡ä¸€äº›ä¿®æ”¹(ä¾‹å¦‚å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•´æ•°)ï¼Œç„¶åå¤„ç†å‡½æ•°æ‰èƒ½æ­£ç¡®çš„å¤„ç†ã€‚æˆ–è€…æŸäº›æ•°æ®å…·æœ‰é»˜è®¤å€¼ï¼Œå½“ç”¨æˆ·æ²¡æœ‰ä¼ é€’è¿™äº›æ•°æ®æ—¶ï¼Œå°±ä½¿ç”¨é»˜è®¤å€¼ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* parse-int.pipe.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> PipeTransform<span class="token punctuation">,</span> Injectable<span class="token punctuation">,</span> ArgumentMetadata<span class="token punctuation">,</span> BadRequestException <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ParseIntPipe</span> <span class="token keyword">implements</span> <span class="token class-name">PipeTransform<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token function">transform</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> metadata<span class="token operator">:</span> ArgumentMetadata<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> val <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BadRequestException</span><span class="token punctuation">(</span><span class="token string">&quot;Validation failed&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> val
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ä¸Šé¢è¿™ä¸ªç®¡é“æ¥å¤„ç†å‚æ•°ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;:id&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findOne</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Param</span></span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span> newew <span class="token function">ParseIntPipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="è·¯ç”±å®ˆå«" tabindex="-1"><a class="header-anchor" href="#è·¯ç”±å®ˆå«" aria-hidden="true">#</a> è·¯ç”±å®ˆå«</h2><p>ä¸ Vue çš„è·¯ç”±å®ˆå«ç±»ä¼¼ï¼Œå°±æ˜¯åœ¨è®¿é—®æŒ‡å®šè·¯ç”±å‰è°ƒç”¨ä¸€ä¸ªå¤„ç†å‡½æ•°ï¼Œå¦‚æœè¿”å› true åˆ™ä½¿ç”¨ next() ï¼Œå¦åˆ™é˜»æ‹¦è¿™ä¸ªè®¿é—®ã€‚</p><p>Nest çš„è·¯ç”±å®ˆå«ä½¿ç”¨ <code>@Injectable()</code> è£…é¥°ï¼Œé€šè¿‡ç»§æ‰¿ <code>CanActive</code> æ¥å£å³å¯å®šä¹‰ã€‚</p><p><a href="https://docs.nestjs.cn/8/guards" target="_blank" rel="noopener noreferrer">å®Œæ•´æ–‡æ¡£é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> CanActivate<span class="token punctuation">,</span> ExecutionContext<span class="token punctuation">,</span> Injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">AppGuard</span> <span class="token keyword">implements</span> <span class="token class-name">CanActivate</span> <span class="token punctuation">{</span>
	<span class="token function">canActivate</span><span class="token punctuation">(</span>context<span class="token operator">:</span> ExecutionContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span> <span class="token operator">|</span> Observable<span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://juejin.cn/post/6844903925435498504" target="_blank" rel="noopener noreferrer">å…¶ä»–å‚è€ƒ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="æ‰§è¡Œä¸Šä¸‹æ–‡" tabindex="-1"><a class="header-anchor" href="#æ‰§è¡Œä¸Šä¸‹æ–‡" aria-hidden="true">#</a> æ‰§è¡Œä¸Šä¸‹æ–‡</h3><p>CanActive æ¥å£çš„æ–¹æ³•ä¸­æœ‰ä¸€ä¸ª ExecutionContext å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸ºè¯·æ±‚ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå®šäºå¦‚ä¸‹ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ExecutionContext</span> <span class="token keyword">extends</span> <span class="token class-name">ArgumentsHost</span> <span class="token punctuation">{</span>
	<span class="token comment">// è·å–å½“å‰è®¿é—®çš„ Controller å¯¹è±¡ï¼ˆä¸æ˜¯å®ä¾‹ï¼‰ï¼ŒT ä¸ºè°ƒç”¨æ—¶ä¼ å…¥çš„å…·ä½“æ§åˆ¶å™¨å¯¹è±¡æ³›å‹å‚æ•°</span>
	<span class="token generic-function"><span class="token function">getClass</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Type<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span>
	<span class="token comment">// è·å–å½“å‰è®¿é—®è·¯ç”±çš„æ–¹æ³•</span>
	<span class="token function">getHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Function</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ExecutionContext ç»§æ‰¿è‡ª ArgumentsHostï¼Œå¯¹äº ArgumentsHost çš„è¯¦ç»†ä¿¡æ¯å¯ä»¥åœ¨<strong>å¼‚å¸¸è¿‡æ»¤å™¨</strong>ç« èŠ‚æŸ¥çœ‹ã€‚</p><h3 id="è·¯ç”±å®ˆå«çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#è·¯ç”±å®ˆå«çº§åˆ«" aria-hidden="true">#</a> è·¯ç”±å®ˆå«çº§åˆ«</h3><p>åŒæ ·çš„ï¼Œè·¯ç”±å®ˆå«ä¹Ÿåˆ†ä¸ºä¸‰ç§ï¼šå…¨å±€ã€æ§åˆ¶å™¨ã€æ–¹æ³•</p><ul><li><p>å…¨å±€çº§åˆ«ï¼šä¸å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨ç±»ä¼¼ï¼Œå¯¹æ‰€æœ‰æ§åˆ¶å™¨çš„æ‰€æœ‰è·¯ç”±æ–¹æ³•ç”Ÿæ•ˆï¼Œä¸ä¼šå¯¹ WebSocket å’Œ GRPC ç”Ÿæ•ˆã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
	<span class="token comment">// ç”±äº main.ts å¯åŠ¨æ—¶å¹¶æœªåˆå§‹åŒ–ä¾èµ–æ³¨å…¥å®¹å™¨ï¼Œæ‰€ä»¥ä¾èµ–å¿…é¡»æ‰‹åŠ¨ä¼ å…¥ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸å»ºè®®ä½¿ç”¨å…¨å±€å®ˆå«ï¼Œå› ä¸ºä¾èµ–æ³¨å…¥å¾—è‡ªå·±è§£å†³ã€‚</span>
	app<span class="token punctuation">.</span><span class="token function">useGlobalGuards</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UserGuard</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UserService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ§åˆ¶å™¨çº§åˆ«ï¼šè¯¥çº§åˆ«å¯¹è¿™ä¸ªæ§åˆ¶å™¨çš„æ‰€æœ‰è·¯ç”±æ–¹æ³•ç”Ÿæ•ˆ</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&#39;user&#39;</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">UseGuards</span></span><span class="token punctuation">(</span>UserGuard<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;info&#39;</span><span class="token punctuation">)</span>
  <span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ–¹æ³•çº§åˆ«ï¼šè¿™ä¸ªçº§åˆ«åªå¯¹è¿™ä¸ªæ–¹æ³•ç”Ÿæ•ˆ</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&#39;info&#39;</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">UseGuard</span></span><span class="token punctuation">(</span>UserGuard<span class="token punctuation">)</span>
<span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="åå°„å™¨" tabindex="-1"><a class="header-anchor" href="#åå°„å™¨" aria-hidden="true">#</a> åå°„å™¨</h3><p>Nest æä¾›äº†ä¸€ä¸ª <code>@SetMetadata()</code> è£…é¥°å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªè£…é¥°å™¨å°†å®šåˆ¶å…ƒæ•°æ®é™„åŠ åˆ°è·¯ç”±å¤„ç†ç¨‹åºã€‚è¿™äº›å…ƒæ•°æ®æä¾›äº†æˆ‘ä»¬ç¼ºå°‘çš„æ•°æ®ï¼Œè€Œå®ˆå«éœ€è¦é€šè¿‡è¿™äº›æ•°æ®æ¥åšå‡ºåˆ¤æ–­ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* cats.controller.ts */</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// roles æ˜¯ä¸€ä¸ªé”®ï¼Œ[&#39;admin&#39;] æ˜¯ä¸€ä¸ªç‰¹å®šçš„å€¼ï¼Œè¿™ä¸¤ä¸ªç»„æˆäº† roles çš„å…ƒæ•°æ®ï¼Œè¿™é‡Œå°†è¿™ä¸ªå…ƒæ•°æ®é™„åŠ åˆ° create() æ–¹æ³•</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">SetMetadata</span></span><span class="token punctuation">(</span><span class="token string">&#39;roles&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;admin&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ç„¶ï¼ŒNest å¹¶ä¸æ¨èç›´æ¥ä½¿ç”¨ <code>@SetMetadata()</code> è£…é¥°å™¨ï¼Œè€Œæ›´æ¨èæˆ‘ä»¬åˆ›å»ºè‡ªå·±çš„è£…é¥°å™¨æ¥ä½¿ç”¨ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* roles.decorator.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> SetMetadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">Roles</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>roles<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">SetMetadata</span><span class="token punctuation">(</span><span class="token string">&quot;roles&quot;</span><span class="token punctuation">,</span> roles<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>ä½¿ç”¨è‡ªå®šä¹‰çš„è£…é¥°å™¨</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* cats.controller.ts */</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Roles</span></span><span class="token punctuation">(</span><span class="token string">&#39;admin&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createCatDto<span class="token operator">:</span> CreateCatDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createCatDto<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="ç¤ºä¾‹-åŸºäºè§’è‰²çš„æƒé™éªŒè¯" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹-åŸºäºè§’è‰²çš„æƒé™éªŒè¯" aria-hidden="true">#</a> ç¤ºä¾‹ï¼šåŸºäºè§’è‰²çš„æƒé™éªŒè¯</h3><ul><li><p>å®šä¹‰è§’è‰²è£…é¥°å™¨ï¼šè¢«è§’è‰²è£…é¥°å™¨è£…é¥°çš„æ§åˆ¶å™¨æˆ–è€…æ–¹æ³•åœ¨è®¿é—®æ—¶ï¼Œè·¯ç”±å®ˆå«ä¼šè¯»å–å½“å‰ç”¨æˆ·çš„è§’è‰²ï¼Œä¸è£…é¥°å™¨ä¼ å…¥çš„è§’è‰²è¿›è¡ŒåŒ¹é…ï¼Œè‹¥å¤±è´¥åˆ™é˜»æ–­è¯·æ±‚ï¼Œå¦åˆ™æ”¾è¡Œã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* roles.decorator.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> SetMetadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/common&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Roles</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>roles<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">SetMetadata</span><span class="token punctuation">(</span><span class="token string">&#39;roles&#39;</span><span class="token punctuation">,</span> roles<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å®šä¹‰æ§åˆ¶å™¨ï¼šå‡è®¾æœ‰ä¸€ä¸ªåªå…è®¸ç®¡ç†å‘˜è®¿é—®çš„åˆ›å»ºç”¨æˆ·çš„æ¥å£</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Post</span></span><span class="token punctuation">(</span><span class="token string">&#39;create&#39;</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Roles</span></span><span class="token punctuation">(</span><span class="token string">&#39;admin&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Body</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> createUserDto<span class="token operator">:</span> CreateUserDto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createUserDto<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å®šä¹‰è·¯ç”±å®ˆå«</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* role.guard.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> CanActivate<span class="token punctuation">,</span> ExecutionContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Reflector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/core&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">RolesGuard</span> <span class="token keyword">implements</span> <span class="token class-name">CanActivate</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">readonly</span> reflector<span class="token operator">:</span> Reflector<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

	<span class="token function">canActivate</span><span class="token punctuation">(</span>context<span class="token operator">:</span> ExecutinContext<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>
		<span class="token comment">// è·å– roles å…ƒæ•°æ®ï¼Œroles ä¸ roles.decorator.ts ä¸­ SetMetadata() ç¬¬ä¸€ä¸ªå‚æ•°(é”®)ä¸€è‡´</span>
		<span class="token keyword">const</span> roles <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>reflector<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;roles&quot;</span><span class="token punctuation">,</span> context<span class="token punctuation">.</span><span class="token function">getHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>roles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// æœªè¢«è£…é¥°å™¨è£…é¥°ï¼Œç›´æ¥æ”¾è¡Œ</span>
			<span class="token keyword">return</span> <span class="token boolean">true</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">const</span> request <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">switchToHttp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">const</span> user <span class="token operator">=</span> request<span class="token punctuation">.</span>user
		<span class="token comment">// è¯»å–è¯·æ±‚å¯¹è±¡çš„ userï¼Œè¯¥userå¯¹è±¡å¯ä»¥é€šè¿‡ä¸­é—´ä»¶æ¥è®¾ç½®</span>
		<span class="token keyword">const</span> <span class="token function-variable function">hasRole</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> user<span class="token punctuation">.</span>roles<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> roles<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>roles <span class="token operator">&amp;&amp;</span> <span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ä½¿ç”¨ <code>Reflector</code> ç±»æ¥è®¿é—®è·¯ç”±çš„è‡ªå®šä¹‰å…ƒæ•°æ®</p></blockquote></li></ul><h2 id="æ‹¦æˆªå™¨" tabindex="-1"><a class="header-anchor" href="#æ‹¦æˆªå™¨" aria-hidden="true">#</a> æ‹¦æˆªå™¨</h2><p>æ‹¦æˆªå™¨æ˜¯åŸºäº AOP(é¢å‘åˆ‡é¢ç¼–ç¨‹)ç¼–ç¨‹æ€æƒ³çš„ä¸€ç§åº”ç”¨ï¼Œå¸¸ç”¨åŠŸèƒ½æœ‰ï¼š</p><ul><li>åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æˆ–ä¹‹åæ‰§è¡Œ<strong>é¢å¤–é€»è¾‘</strong>ï¼Œè¿™äº›é€»è¾‘ä¸€èˆ¬ä¸å±äºä¸šåŠ¡çš„ä¸€éƒ¨åˆ†</li><li><strong>è½¬æ¢</strong>å‡½æ•°è¿”å›çš„ç»“æœ</li><li><strong>è½¬æ¢</strong>å‡½æ•°æŠ›å‡ºçš„å¼‚å¸¸</li><li>æ‹“å±•å‡½æ•°çš„åŸºæœ¬è¡Œä¸º</li><li>æ ¹æ®åœºæ™¯å®Œå…¨é‡å†™å‡½æ•°</li></ul><p><a href="https://docs.nestjs.cn/8/interceptors" target="_blank" rel="noopener noreferrer">å®Œæ•´æ–‡æ¡£é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://juejin.cn/post/6844903939196846087" target="_blank" rel="noopener noreferrer">å…¶ä»–å‚è€ƒæ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="åŸºç¡€" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€" aria-hidden="true">#</a> åŸºç¡€</h3><p>æ¯ä¸ªæ‹¦æˆªå™¨éƒ½å«æœ‰ <code>intercept()</code> æ–¹æ³•ï¼Œä»–æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š</p><ol><li><p><code>ExecutionContext</code> å®ä¾‹ï¼šä¸å®ˆå«å®Œå…¨ç›¸åŒçš„å¯¹è±¡ï¼Œç»§æ‰¿è‡ª <code>ArgumentsHost</code> ã€‚</p></li><li><p><code>CallHandler</code> ï¼šè·¯ç”±å¤„ç†å‡½æ•°ã€‚</p><p>æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">CallHandler<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token comment">// è¿™æ˜¯ä¸€ä¸ª RxJs åŒ…è£…å¯¹è±¡</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>handle()</code> å‡½æ•°çš„è¿”å›å€¼ä¹Ÿå°±æ˜¯å¯¹åº”è·¯ç”±å‡½æ•°çš„è¿”å›å€¼ã€‚å¦‚ä¸‹ï¼Œå½“è®¿é—® <code>/user/list</code> æ—¶ï¼Œè·¯ç”±å¤„ç†å‡½æ•°è¿”å› <code>[]</code> ï¼Œåœ¨åº”ç”¨æ‹¦æˆªå™¨çš„æƒ…å†µä¸‹ï¼Œè°ƒç”¨äº† <code>handle()</code> æ–¹æ³•åå¾—åˆ°çš„ä¹Ÿæ˜¯ <code>Obervable&lt;[]&gt;</code> ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* user.controller.ts */</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
	<span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">)</span>
	<span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><h5 id="æ³¨-3" tabindex="-1"><a class="header-anchor" href="#æ³¨-3" aria-hidden="true">#</a> æ³¨</h5><p>å¦‚æœåœ¨æ‹¦æˆªå™¨ä¸­è°ƒç”¨äº† next.handle() æ–¹æ³•ï¼Œå°±ä¼šæ‰§è¡Œå¯¹åº”çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼Œå¦‚æœä¸è°ƒç”¨çš„è¯å°±ä¸ä¼šæ‰§è¡Œã€‚</p></blockquote></li></ol><h3 id="å®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨" tabindex="-1"><a class="header-anchor" href="#å®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨" aria-hidden="true">#</a> å®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨</h3><p>è¿™ä¸ªç¤ºä¾‹æ˜¯ï¼šåœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æˆ–ä¹‹åæ‰§è¡Œ<strong>é¢å¤–é€»è¾‘</strong>ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* logging.interceptor.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> NestInterceptor<span class="token punctuation">,</span> ExecutionContext<span class="token punctuation">,</span> CallHandler <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Observable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> tap <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;rxjs/operators&quot;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LoggingInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">NestInterceptor</span> <span class="token punctuation">{</span>
	<span class="token function">intercept</span><span class="token punctuation">(</span>context<span class="token operator">:</span> ExecutionContext<span class="token punctuation">,</span> next<span class="token operator">:</span> CallHandler<span class="token punctuation">)</span><span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
		<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Before...&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">const</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> next<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">After... </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> now<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ms</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token comment">// ç”±äº handle() è¿”å›ä¸€ä¸ª RxJS Observableï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šç§æ“ä½œç¬¦å¯ä»¥ç”¨æ¥æ“ä½œæµã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† tap() è¿ç®—ç¬¦ï¼Œè¯¥è¿ç®—ç¬¦åœ¨å¯è§‚å¯Ÿåºåˆ—çš„æ­£å¸¸æˆ–å¼‚å¸¸ç»ˆæ­¢æ—¶è°ƒç”¨å‡½æ•°ã€‚</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ‹¦æˆªå™¨ä½œç”¨åŸŸ" tabindex="-1"><a class="header-anchor" href="#æ‹¦æˆªå™¨ä½œç”¨åŸŸ" aria-hidden="true">#</a> æ‹¦æˆªå™¨ä½œç”¨åŸŸ</h3><p>åŒæ ·çš„ï¼Œæ‹¦æˆªå™¨ä½œç”¨åŸŸä¹Ÿæœ‰ä¸‰ç§ï¼šå…¨å±€ã€æ§åˆ¶å™¨ã€è·¯ç”±æ–¹æ³•</p><ul><li><p>å…¨å±€æ‹¦æˆªå™¨ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* main.ts */</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">useGlobalInterceptors</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AppInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ§åˆ¶å™¨æ‹¦æˆªå™¨ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">UseInterceptors</span></span><span class="token punctuation">(</span>AppInterceptor<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>è·¯ç”±æ–¹æ³•æ‹¦æˆªå™¨ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Controller</span></span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
	<span class="token decorator"><span class="token at operator">@</span><span class="token function">UseInterceptors</span></span><span class="token punctuation">(</span>AppInterceptor<span class="token punctuation">)</span>
	<span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="è‡ªå®šä¹‰è£…é¥°å™¨" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰è£…é¥°å™¨" aria-hidden="true">#</a> è‡ªå®šä¹‰è£…é¥°å™¨</h2><p><a href="https://docs.nestjs.cn/8/customdecorators" target="_blank" rel="noopener noreferrer">å®Œæ•´æ–‡æ¡£é“¾æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="è£…é¥°å™¨" tabindex="-1"><a class="header-anchor" href="#è£…é¥°å™¨" aria-hidden="true">#</a> è£…é¥°å™¨</h3><p>Nest æ˜¯åŸºäºè£…é¥°å™¨è¿™ç§è¯­è¨€ç‰¹æ€§è€Œåˆ›å»ºçš„ã€‚ç®€å•æ¥è¯´ï¼Œ<code>ES2016</code> çš„è£…é¥°å™¨æ˜¯ä¸€ä¸ªå¯ä»¥å°†ç›®æ ‡å¯¹è±¡ã€åç§°å’Œå±æ€§æè¿°ç¬¦ä½œä¸ºå‚æ•°çš„è¿”å›å‡½æ•°çš„è¡¨è¾¾å¼ã€‚è£…é¥°å™¨ä½¿ç”¨ <code>@</code> å‰ç¼€æ¥ä½¿ç”¨ã€‚è£…é¥°å™¨å¯ä»¥æ”¾ç½®åœ¨æƒ³è¦è£…é¥°çš„å¯¹è±¡çš„æœ€é¡¶ç«¯ã€‚è£…é¥°å™¨å¯ä»¥è¢«å®šä¹‰ä¸ºä¸€ä¸ªç±»æˆ–æ˜¯å±æ€§ã€‚</p><h3 id="è‡ªå®šä¹‰" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰" aria-hidden="true">#</a> è‡ªå®šä¹‰</h3><p>è¿™é‡Œåˆ›å»ºä¸€ä¸ª <code>@User()</code> è£…é¥°å™¨å¹¶åœ¨æ‰€æœ‰æ§åˆ¶å™¨ä¸­é‡å¤åˆ©ç”¨ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* user.decorator.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createParamDecorator<span class="token punctuation">,</span> ExecutionContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>

<span class="token comment">// è¿™ä¸ªè£…é¥°å™¨çš„ä½œç”¨æ˜¯å°† user è¿™ä¸ªå±æ€§é™„åŠ åˆ° request å¯¹è±¡ä¸Šï¼Œæ–¹ä¾¿åœ¨è·¯ç”±æ–¹æ³•ä¸­è®¿é—®</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">createParamDecorator</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">,</span> ctx<span class="token operator">:</span> ExecutionContext<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> request <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">switchToHttp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> request<span class="token punctuation">.</span>user
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>ä½¿ç”¨ <code>@User()</code> ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findOne</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">User</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> user<span class="token operator">:</span> UserEntity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="ä¼ é€’æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ä¼ é€’æ•°æ®" aria-hidden="true">#</a> ä¼ é€’æ•°æ®</h3><p>å½“è£…é¥°å™¨çš„è¡Œä¸ºå–å†³äºæŸäº›æ¡ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>data</code> å‚æ•°å°†å…¶ä¼ é€’ç»™è£…é¥°å™¨çš„å·¥å‚å‡½æ•°ã€‚</p><p>è¿™é‡Œï¼Œå‡è®¾æˆ‘ä»¬çš„èº«ä»½éªŒè¯å±‚éªŒè¯è¯·æ±‚å¹¶å°†ç”¨æˆ·å®ä½“é™„åŠ åˆ°è¯·æ±‚å¯¹è±¡ï¼Œç»è¿‡èº«ä»½éªŒè¯çš„è¯·æ±‚çš„ç”¨æˆ·å®ä½“å¯èƒ½ç±»ä¼¼äºï¼š</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">101</span><span class="token punctuation">,</span>
	<span class="token property">&quot;firstName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Alan&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;lastName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Turing&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;alan@email.com&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;roles&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®šä¹‰ä¸€ä¸ªå°†å±æ€§åä½œä¸ºé”®çš„è£…é¥°å™¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›ç›¸å…³è”çš„å€¼ï¼Œå¦‚æœä¸å­˜åœ¨æˆ–è€…è¿˜æ²¡æœ‰åˆ›å»º user å¯¹è±¡ï¼Œåˆ™è¿”å› undefinedã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">/* user.decorator.ts */</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createParamDecorator<span class="token punctuation">,</span> ExecutionContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@nestjs/common&quot;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> User <span class="token operator">=</span> <span class="token function">createParamDecorator</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> ctx<span class="token operator">:</span> ExecutionContext<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> request <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">switchToHttp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> user <span class="token operator">=</span> request<span class="token punctuation">.</span>user
	<span class="token keyword">return</span> data <span class="token operator">?</span> user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">[</span>data<span class="token punctuation">]</span> <span class="token operator">:</span> user
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ <code>@User()</code> è£…é¥°å™¨è®¿é—®ç‰¹å®šå±æ€§</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findOne</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">User</span></span><span class="token punctuation">(</span><span class="token string">&#39;firstName&#39;</span><span class="token punctuation">)</span> firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>firstName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><!----></div></footer><nav class="page-nav"><!----><a href="/docs/node/nestjs%E5%8D%9A%E5%AE%A2%E6%8E%A5%E5%8F%A3%E6%A1%88%E4%BE%8B.html" class="nav-link next" aria-label="ä¸€ä¸ªä½¿ç”¨ NestJs ç¼–å†™çš„ç®€å•CRUDæ¡ˆä¾‹"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">ä¸€ä¸ªä½¿ç”¨ NestJs ç¼–å†™çš„ç®€å•CRUDæ¡ˆä¾‹<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!----></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/docs/assets/app-0ea0852b.js" defer></script>
  </body>
</html>
